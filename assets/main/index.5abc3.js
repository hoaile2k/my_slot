window.__require=function e(t,n,o){function r(s,a){if(!n[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!a&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){return r(t[s][1][e]||e)},u,u.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<o.length;s++)r(o[s]);return r}({APIHandler:[function(e,t,n){"use strict";cc._RF.push(t,"6cdf006T0BNXrpvCl2T2vBT","APIHandler");var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.APIHandler=void 0;var s=function(){function e(){this.profileHost="",this.gameHost="",this.jwt=""}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.buildHeaders=function(e){void 0===e&&(e=!0);var t={};return e&&(t["Content-Type"]="application/json"),this.jwt&&(t.Authorization="Bearer "+this.jwt),t},e.prototype.fetchWithRetry=function(e,t,n){return void 0===n&&(n=3),r(this,void 0,Promise,function(){var r,s,a,c,l,u;return i(this,function(p){switch(p.label){case 0:r=n,s=null,a=!1,c=function(){var c,u,p,h,f,d,y;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,12,,13]),[4,fetch(e,t)];case 1:c=i.sent(),u=null,i.label=2;case 2:return i.trys.push([2,4,,9]),[4,c.json()];case 3:return u=i.sent(),[3,9];case 4:i.sent(),i.label=5;case 5:return i.trys.push([5,7,,8]),[4,c.clone().json()];case 6:return u=i.sent(),[3,8];case 7:return p=i.sent(),u=null,[3,8];case 8:return[3,9];case 9:return c.ok?(r<n&&console.log("[APIHandler] Request succeeded after "+(n-r)+" retry(ies): "+e),[2,{value:null!=u?u:null}]):429===c.status?(console.warn("[APIHandler] Rate limit exceeded: "+e),[2,"break"]):401!==c.status||!l.tokenRefresher||a?[3,11]:(console.log("[APIHandler] Unauthorized (401). Attempting token refresh..."),a=!0,[4,l.tokenRefresher()]);case 10:return i.sent()?(h=new Headers(t.headers||{}),f=l.buildHeaders(!h.has("Content-Type")||(null===(p=h.get("Content-Type"))||void 0===p?void 0:p.includes("application/json"))),Object.entries(f).forEach(function(e){var t=e[0],n=e[1];h.set(t,n)}),t=o(o({},t),{headers:h}),[2,"continue"]):(console.error("[APIHandler] Token refresh failed for: "+e),[2,"break"]);case 11:return r--,console.warn("[APIHandler] Request failed with status "+c.status+": "+e),s=u,[3,13];case 12:return d=i.sent(),r--,console.error("[APIHandler] Error fetching data from "+e+":",d),0===r?[2,{value:s}]:[3,13];case 13:return y=300*(n-r),[4,new Promise(function(e){return setTimeout(e,y)})];case 14:return i.sent(),[2]}})},l=this,p.label=1;case 1:return r>0?[5,c()]:[3,3];case 2:return"object"==typeof(u=p.sent())?[2,u.value]:"break"===u?[3,3]:[3,1];case 3:return console.error("[APIHandler] Request failed after "+n+" retries: "+e),[2,s]}})})},e.prototype.get=function(e,t){return void 0===t&&(t=3),r(this,void 0,Promise,function(){var n;return i(this,function(){return n={method:"GET",headers:this.buildHeaders()},[2,this.fetchWithRetry(e,n,t)]})})},e.prototype.post=function(e,t,n){return void 0===n&&(n=3),r(this,void 0,Promise,function(){var o;return i(this,function(){return o={method:"POST",headers:this.buildHeaders(),body:JSON.stringify(e)},[2,this.fetchWithRetry(t,o,n)]})})},e.prototype.put=function(e,t,n){return void 0===n&&(n=3),r(this,void 0,Promise,function(){var o;return i(this,function(){return o={method:"PUT",headers:this.buildHeaders(),body:JSON.stringify(e)},[2,this.fetchWithRetry(t,o,n)]})})},e.prototype.putFormData=function(e,t,n){return void 0===n&&(n=3),r(this,void 0,Promise,function(){var o;return i(this,function(){return o={method:"PUT",headers:this.buildHeaders(!1),body:e},[2,this.fetchWithRetry(t,o,n)]})})},e.prototype.registerTokenRefresher=function(e){this.tokenRefresher=e,console.log("[APIHandler] Token refresher registered")},e.prototype.fetchWithTimeout=function(e,t,n){return r(this,void 0,Promise,function(){var r,s,a,c;return i(this,function(i){switch(i.label){case 0:r=new AbortController,s=setTimeout(function(){return r.abort()},n),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e,o(o({},t),{signal:r.signal}))];case 2:return a=i.sent(),clearTimeout(s),[2,a];case 3:return c=i.sent(),clearTimeout(s),c instanceof Error&&"AbortError"===c.name?console.error("[APIHandler] Request timeout after "+n+"ms: "+e):console.error("[APIHandler] Request error: "+e,c),[2,null];case 4:return[2]}})})},e}();n.APIHandler=s,cc._RF.pop()},{}],AndroidNoSleep:[function(e,t,n){"use strict";cc._RF.push(t,"c2dc4SmMDdF+KaNe2pe56G4","AndroidNoSleep");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.AndroidNoSleep=void 0;var i=function(){function e(){this._isEnabled=!1}return e.prototype.startService=function(){return o(this,void 0,Promise,function(){return r(this,function(){return cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID?(cc.log("[AndroidNoSleep] Starting NoSleep service for Android"),[2]):(cc.warn("[AndroidNoSleep] NoSleep only supports Android platform."),[2])})})},e.prototype.enable=function(){cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID?this._isEnabled?cc.log("[AndroidNoSleep] NoSleep is already enabled"):(cc.warn("[AndroidNoSleep] TO DO IMPLEMENTATION FOR ENABLE NO SLEEP"),this._isEnabled=!0):cc.warn("[AndroidNoSleep] NoSleep only supports Android platform.")},e.prototype.disable=function(){this._isEnabled&&(cc.warn("[AndroidNoSleep] TO DO IMPLEMENTATION FOR DISABLE NO SLEEP"),this._isEnabled=!1)},e.prototype.toggle=function(){this._isEnabled=!this._isEnabled,this._isEnabled?this.enable():this.disable()},e.prototype.isEnabled=function(){return this._isEnabled},e}();n.AndroidNoSleep=i,cc._RF.pop()},{}],ApiTypes:[function(e,t,n){"use strict";cc._RF.push(t,"6cecanQUL9H/YbJFb5vofkN","ApiTypes"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],ApiURL:[function(e,t,n){"use strict";cc._RF.push(t,"626e0joYOdFxK+VqPzwyHHT","ApiURL"),Object.defineProperty(n,"__esModule",{value:!0}),n.EnvDir=n.ApiURL=void 0,function(e){e.BASE_URL="https://slot-stag.osyamazakiglobel.club/api",e.WS_BASE_URL="wss://slot-stag.osyamazakiglobel.club/game",e.POST_REGISTER="/auth/register",e.POST_LOGIN="/auth/login",e.POST_REFRESH_TOKEN="/auth/refresh",e.GET_BALANCE="/wallet/balance",e.GET_TRANSACTIONS_HISTORY="/wallet/transactions",e.GET_CONFIGURATION="/game/config",e.GET_SETTINGS="/game/settings",e.GET_FREE_SPINS="/bonus/free-spins/status"}(n.ApiURL||(n.ApiURL={})),function(e){e.LOCAL="",e.DEV="",e.STAGING="",e.PROD=""}(n.EnvDir||(n.EnvDir={})),cc._RF.pop()},{}],AppController:[function(e,t,n){"use strict";cc._RF.push(t,"8a399VrRcJNZZhHpAZsgTZz","AppController");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=(c.property,e("./login/LoginManager")),p=e("./screen/ScreenManager"),h=e("./screen/ScreenConfig"),f=e("./network/GameApiManager"),d=e("./network/GameNetworkManager"),y=e("./network/APIHandler"),g=e("./popup/LoadingOverlay"),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onLoad=function(){return s(this,void 0,Promise,function(){return a(this,function(){return console.log("[AppController] Initializing app..."),[2]})})},t.prototype.start=function(){return s(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.initializeApp()];case 1:return e.sent(),[2]}})})},t.prototype.initializeApp=function(){return s(this,void 0,Promise,function(){var e,t;return a(this,function(n){switch(n.label){case 0:g.LoadingOverlay.show(),g.LoadingOverlay.setLoopingProgressText("Processing...",!0),n.label=1;case 1:return n.trys.push([1,9,,11]),(e=u.LoginManager.instance.isAuthenticated())||!u.LoginManager.instance.getAccessToken()?[3,3]:(console.log("[AppController] Token expired, attempting refresh..."),[4,u.LoginManager.instance.refreshToken()]);case 2:n.sent()?(console.log("[AppController] Token refreshed successfully"),e=!0):console.log("[AppController] Token refresh failed"),n.label=3;case 3:return e?[4,this.initializeGame()]:[3,6];case 4:return n.sent(),[4,this.showMainScreen()];case 5:return n.sent(),g.LoadingOverlay.hide(),[3,8];case 6:return[4,this.showLoginScreen()];case 7:n.sent(),g.LoadingOverlay.hide(),n.label=8;case 8:return[3,11];case 9:return t=n.sent(),console.error("[AppController] Error during initialization:",t),[4,this.showLoginScreen()];case 10:return n.sent(),g.LoadingOverlay.hide(),[3,11];case 11:return[2]}})})},t.prototype.initializeGame=function(){return s(this,void 0,Promise,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),console.log("[AppController] Initializing game data..."),[4,f.GameApiManager.instance.getBalance()];case 1:return n.sent(),(e=y.APIHandler.instance.jwt)?[4,d.default.instance.connect(e)]:[3,3];case 2:n.sent(),n.label=3;case 3:return console.log("[AppController] Game data initialized"),[3,5];case 4:throw t=n.sent(),console.error("[AppController] Error initializing game:",t),t;case 5:return[2]}})})},t.prototype.showLoginScreen=function(){return s(this,void 0,Promise,function(){var e;return a(this,function(t){switch(t.label){case 0:return(e=p.ScreenManager.Instance)?(console.log("[AppController] Showing login screen"),[4,e.showScreen(h.ScreenType.MAIN)]):[3,2];case 1:return t.sent(),[3,3];case 2:console.error("[AppController] ScreenManager not found"),t.label=3;case 3:return[2]}})})},t.prototype.showMainScreen=function(){return s(this,void 0,Promise,function(){var e;return a(this,function(t){switch(t.label){case 0:return(e=p.ScreenManager.Instance)?(console.log("[AppController] Showing main screen"),[4,e.showScreen(h.ScreenType.MAIN)]):[3,2];case 1:return t.sent(),[3,3];case 2:console.error("[AppController] ScreenManager not found"),t.label=3;case 3:return[2]}})})},i([l],t)}(cc.Component);n.default=m,cc._RF.pop()},{"./login/LoginManager":"LoginManager","./network/APIHandler":"APIHandler","./network/GameApiManager":"GameApiManager","./network/GameNetworkManager":"GameNetworkManager","./popup/LoadingOverlay":"LoadingOverlay","./screen/ScreenConfig":"ScreenConfig","./screen/ScreenManager":"ScreenManager"}],AsyncUtils:[function(e,t,n){"use strict";cc._RF.push(t,"a3728WYt39LPIf4tMCtH01s","AsyncUtils");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};function i(){return new Promise(function(e){try{cc.director.once(cc.Director.EVENT_AFTER_UPDATE,function(){e()})}catch(t){console.error("[AsyncUtil] Error in nextFrame:",t),e()}})}Object.defineProperty(n,"__esModule",{value:!0}),n.waitUntilInterval=n.waitEvent=n.waitForFrames=n.waitUntil=n.sleep=n.nextFrame=void 0,n.nextFrame=i,n.sleep=function(e){return void 0===e&&(e=0),new Promise(function(t){try{var n=1e3*e;if(n<0||!isFinite(n))return console.warn("[AsyncUtil] Invalid sleep duration:",e),void t();setTimeout(function(){t()},n)}catch(o){console.error("[AsyncUtil] Error in sleep:",o),t()}})},n.waitUntil=function(e,t){return void 0===t&&(t=1/0),o(this,void 0,Promise,function(){var n,o,s,a,c;return r(this,function(r){switch(r.label){case 0:if(!e||"function"!=typeof e)return console.error("[AsyncUtil] Invalid condition function"),[2,!1];r.label=1;case 1:r.trys.push([1,5,,6]),n=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()},o=t===1/0?1/0:n()+1e3*t,s=0,a=1e4,r.label=2;case 2:try{if(e())return[2,!0]}catch(l){return console.error("[AsyncUtil] Error in condition function:",l),[2,!1]}return n()>o?[2,!1]:++s>a?(console.warn("[AsyncUtil] waitUntil exceeded max iterations"),[2,!1]):[4,i()];case 3:return r.sent(),[3,2];case 4:return[3,6];case 5:return c=r.sent(),console.error("[AsyncUtil] Error in waitUntil:",c),[2,!1];case 6:return[2]}})})},n.waitForFrames=function(e){return void 0===e&&(e=1),o(this,void 0,Promise,function(){var t,n;return r(this,function(o){switch(o.label){case 0:if(e<0||!isFinite(e))return console.warn("[AsyncUtil] Invalid frame count:",e),[2];o.label=1;case 1:o.trys.push([1,5,,6]),t=Math.floor(e),o.label=2;case 2:return t>0?[4,i()]:[3,4];case 3:return o.sent(),t--,[3,2];case 4:return[3,6];case 5:return n=o.sent(),console.error("[AsyncUtil] Error in waitForFrames:",n),[3,6];case 6:return[2]}})})},n.waitEvent=function(e,t,n){return void 0===n&&(n=0),new Promise(function(o){if(!e||!t)return console.error("[AsyncUtil] Invalid target or event type"),void o(null);var r=null,i=!1,s=function(){if(!i){i=!0;try{e.off(t,a)}catch(n){console.error("[AsyncUtil] Error removing event listener:",n)}r&&(clearTimeout(r),r=null)}},a=function(e){s(),o(e)};try{e.on(t,a),n>0&&(r=setTimeout(function(){s(),o(null)},1e3*n))}catch(c){console.error("[AsyncUtil] Error in waitEvent:",c),s(),o(null)}})},n.waitUntilInterval=function(e,t,n){return void 0===t&&(t=50),void 0===n&&(n=0),new Promise(function(o){if(!e||"function"!=typeof e)return console.error("[AsyncUtil] Invalid condition function"),void o(!1);if(t<0||!isFinite(t))return console.warn("[AsyncUtil] Invalid interval:",t),void o(!1);var r=null,i=!1,s=function(){i||(i=!0,r&&(clearInterval(r),r=null))};try{var a=Date.now();r=setInterval(function(){try{if(e())return s(),void o(!0);if(n>0&&Date.now()-a>=n)return s(),void o(!1)}catch(t){console.error("[AsyncUtil] Error in condition function:",t),s(),o(!1)}},t)}catch(c){console.error("[AsyncUtil] Error in waitUntilInterval:",c),s(),o(!1)}})},cc._RF.pop()},{}],BasePopup:[function(e,t,n){"use strict";cc._RF.push(t,"ca62c/NUT5KObBjmDC/FiGU","BasePopup");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.BasePopup=void 0;var s=cc._decorator,a=s.ccclass,c=s.property,l=e("./PopupConfig"),u=e("./PopupData"),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=l.PopupType.GENERIC_POPUP,t.storage=u.PopupStorage.CACHE,t.btnCloses=[],t.contentContainer=null,t.showAnimationData=[],t.hideAnimationData=[],t.onCloseCallback=function(){},t.currentTween=null,t.isInitialized=!1,t.isDeactivating=!1,t}return r(t,e),t.prototype.onLoad=function(){this.node.active=!1,this.initialize()},t.prototype.onEnable=function(){this.isInitialized||this.initialize()},t.prototype.onDisable=function(){},t.prototype.onDestroy=function(){this.stopAnimation(),this.cleanup()},t.prototype.initialize=function(){this.isInitialized||(this.setupUI(),this.isInitialized=!0)},t.prototype.setupUI=function(){if(this.btnCloses&&this.btnCloses.length>0)for(var e=0,t=this.btnCloses;e<t.length;e++){var n=t[e];n&&n.node&&n.node.on("click",this.onCloseButtonClick,this)}},t.prototype.onDataReceived=function(e){this.data=e},t.prototype.onShow=function(){},t.prototype.onHide=function(){},t.prototype.cleanup=function(){if(this.stopAnimation(),this.btnCloses&&this.btnCloses.length>0)for(var e=0,t=this.btnCloses;e<t.length;e++){var n=t[e];n&&n.node&&n.node.off("click",this.onCloseButtonClick,this)}this.onCloseCallback=function(){},this.data=null},t.prototype.setup=function(e){this.isDeactivating?console.warn("[BasePopup] Cannot setup popup while deactivating"):((null==e?void 0:e.onClose)&&(this.onCloseCallback=e.onClose),void 0!==(null==e?void 0:e.storage)&&(this.storage=e.storage),this.onDataReceived(e),this.active(),this.playShowAnimation(),this.onShow())},t.prototype.active=function(){this.node.active=!0,this.isDeactivating=!1},t.prototype.deactive=function(){this.node.active&&!this.isDeactivating&&(this.isDeactivating=!0,this.onHide(),this.playHideAnimation())},t.prototype.onCloseButtonClick=function(){this.deactive()},t.prototype.playShowAnimation=function(){if(this.contentContainer){this.stopAnimation(),this.contentContainer.setScale(0,0),this.currentTween=cc.tween(this.contentContainer);for(var e=0,t=this.showAnimationData;e<t.length;e++){var n=t[e];this.currentTween.to(n.time,{scaleX:n.scale.x,scaleY:n.scale.y})}this.currentTween.start()}},t.prototype.playHideAnimation=function(){var e=this;if(this.contentContainer){this.stopAnimation(),this.currentTween=cc.tween(this.contentContainer);for(var t=0,n=this.hideAnimationData;t<n.length;t++){var o=n[t];this.currentTween.to(o.time,{scaleX:o.scale.x,scaleY:o.scale.y})}this.currentTween.call(function(){e.handleDeactive()}).start()}else this.handleDeactive()},t.prototype.stopAnimation=function(){this.currentTween&&(this.currentTween.stop(),this.currentTween=null)},t.prototype.handleDeactive=function(){this.node.active=!1,this.isDeactivating=!1;var e=this.onCloseCallback;this.onCloseCallback=function(){},this.storage!==u.PopupStorage.DESTROY&&this.storage!=u.PopupStorage.CACHE||this.node.destroy(),null==e||e()},t.prototype.getPopupType=function(){return this.type},t.prototype.getStorage=function(){return this.storage},t.prototype.isVisible=function(){return this.node.active&&!this.isDeactivating},t.prototype.close=function(){this.deactive()},i([c({type:cc.Enum(l.PopupType)})],t.prototype,"type",void 0),i([c({type:cc.Enum(u.PopupStorage)})],t.prototype,"storage",void 0),i([c([cc.Button])],t.prototype,"btnCloses",void 0),i([c(cc.Node)],t.prototype,"contentContainer",void 0),i([c({type:[u.PopupAnimationData],visible:function(){return!!this.contentContainer}})],t.prototype,"showAnimationData",void 0),i([c({type:[u.PopupAnimationData],visible:function(){return!!this.contentContainer}})],t.prototype,"hideAnimationData",void 0),i([a],t)}(cc.Component);n.BasePopup=p,cc._RF.pop()},{"./PopupConfig":"PopupConfig","./PopupData":"PopupData"}],BaseScreen:[function(e,t,n){"use strict";cc._RF.push(t,"c7e24HHJ9FEBIBXZ3faNMjJ","BaseScreen");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.BaseScreen=n.ScreenAnimationData=void 0;var s=cc._decorator,a=s.ccclass,c=s.property,l=e("./ScreenConfig"),u=function(){function e(){this.time=.2,this.scale=new cc.Vec2(1,1)}return i([c(cc.Float)],e.prototype,"time",void 0),i([c(cc.Vec2)],e.prototype,"scale",void 0),i([a("ScreenAnimationData")],e)}();n.ScreenAnimationData=u;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.screenType=l.ScreenType.NONE,t.contentContainer=null,t.showAnimationData=[],t.hideAnimationData=[],t.currentTween=null,t.isInitialized=!1,t}return r(t,e),t.prototype.onLoad=function(){this.node.active=!1,this.initialize()},t.prototype.onEnable=function(){this.isInitialized||this.initialize(),this.onShow()},t.prototype.onDisable=function(){this.onHide()},t.prototype.onDestroy=function(){this.currentTween&&(this.currentTween.stop(),this.currentTween=null),this.cleanup()},t.prototype.initialize=function(){this.isInitialized||(this.isInitialized=!0,this.setupUI())},t.prototype.setupUI=function(){},t.prototype.setup=function(e){this.data=e,this.onDataReceived(e),this.playShowAnimation()},t.prototype.onDataReceived=function(){},t.prototype.onShow=function(){},t.prototype.onHide=function(){},t.prototype.cleanup=function(){},t.prototype.show=function(){this.node.active=!0},t.prototype.hide=function(){this.node.active=!1},t.prototype.playShowAnimation=function(){if(this.contentContainer){this.currentTween&&this.currentTween.stop(),this.contentContainer.setScale(0,0),this.currentTween=cc.tween(this.contentContainer);for(var e=0,t=this.showAnimationData;e<t.length;e++){var n=t[e];this.currentTween.to(n.time,{scaleX:n.scale.x,scaleY:n.scale.y})}this.currentTween.start()}},t.prototype.playHideAnimation=function(){var e=this;if(this.contentContainer){this.currentTween&&this.currentTween.stop(),this.currentTween=cc.tween(this.contentContainer);for(var t=0,n=this.hideAnimationData;t<n.length;t++){var o=n[t];this.currentTween.to(o.time,{scaleX:o.scale.x,scaleY:o.scale.y})}this.currentTween.call(function(){e.hide()}).start()}else this.hide()},t.prototype.getScreenType=function(){return this.screenType},t.prototype.isVisible=function(){return this.node.active},i([c({type:cc.Enum(l.ScreenType)})],t.prototype,"screenType",void 0),i([c(cc.Node)],t.prototype,"contentContainer",void 0),i([c({type:[u],visible:function(){return!!this.contentContainer}})],t.prototype,"showAnimationData",void 0),i([c({type:[u],visible:function(){return!!this.contentContainer}})],t.prototype,"hideAnimationData",void 0),i([a],t)}(cc.Component);n.BaseScreen=p,cc._RF.pop()},{"./ScreenConfig":"ScreenConfig"}],BaseState:[function(e,t,n){"use strict";cc._RF.push(t,"64703WeTs9K1aeJvZAj4rCY","BaseState");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.BaseState=void 0;var s=e("../command/CommandManager"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRunning=!1,t.wantClearCommand=!0,t.commandManager=new s.CommandManager,t}return r(t,e),t.prototype.registerCommandEvents=function(){},t.prototype.unregisterCommandEvents=function(){},t.prototype.onLoad=function(){this.registerCommandEvents()},t.prototype.start=function(){this.stateId||cc.warn("This state not setup "+this.name)},t.prototype.onDestroy=function(){this.unregisterCommandEvents()},t.prototype.onEnter=function(){this.isRunning=!0,this.onEnterState(),cc.log("Enter "+this.stateName)},t.prototype.onEnterState=function(){},t.prototype.onExit=function(){this.isRunning=!1,this.onExitState(),cc.log("Exit "+this.stateName),this.wantClearCommand&&this.clearAllCommands()},t.prototype.onExitState=function(){},t.prototype.getStateMachine=function(){return this.node.getComponent("StateMachine")},t.prototype.runCommands=function(e,t){this.commandManager.runCommandChannel(e,t)},t.prototype.clearAllCommands=function(){this.commandManager.clearAll()},t.prototype.update=function(e){this.isRunning&&this.commandManager.onUpdate(e)},i([c],t)}(cc.Component));n.BaseState=l,cc._RF.pop()},{"../command/CommandManager":"CommandManager"}],BasicPopup:[function(e,t,n){"use strict";cc._RF.push(t,"392b2UyuthB7amIt4RMOm7D","BasicPopup");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.BasicPopup=void 0;var s=e("./BasePopup"),a=cc._decorator,c=a.ccclass,l=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lbTitle=null,t.lbContent=null,t.lbBtnLeft=null,t.lbBtnRight=null,t.btnLeft=null,t.btnRight=null,t.onLeftBtnClick=function(){},t.onRightBtnClick=function(){},t}return r(t,e),t.prototype.onLoad=function(){var t,n,o=this;e.prototype.onLoad.call(this),null===(t=this.btnLeft)||void 0===t||t.node.on("click",function(){var e;null===(e=o.onLeftBtnClick)||void 0===e||e.call(o)}),null===(n=this.btnRight)||void 0===n||n.node.on("click",function(){var e;null===(e=o.onRightBtnClick)||void 0===e||e.call(o)})},t.prototype.setup=function(t){e.prototype.setup.call(this,t),t&&(t.textBtnLeft&&(this.lbBtnLeft.string=t.textBtnLeft),t.textBtnRight&&(this.lbBtnRight.string=t.textBtnRight),t.title&&(this.lbTitle.string=t.title),t.content&&(this.lbContent.string=t.content),this.onLeftBtnClick=null==t?void 0:t.onBtnLeftClick,this.onRightBtnClick=null==t?void 0:t.onBtnRightClick,this.btnLeft&&(this.btnLeft.node.active=t.textBtnLeft||t.onBtnLeftClick),this.btnRight&&(this.btnRight.node.active=t.textBtnRight||t.onBtnRightClick))},i([l(cc.Label)],t.prototype,"lbTitle",void 0),i([l(cc.Label)],t.prototype,"lbContent",void 0),i([l(cc.Label)],t.prototype,"lbBtnLeft",void 0),i([l(cc.Label)],t.prototype,"lbBtnRight",void 0),i([l(cc.Button)],t.prototype,"btnLeft",void 0),i([l(cc.Button)],t.prototype,"btnRight",void 0),i([c],t)}(s.BasePopup);n.BasicPopup=u,cc._RF.pop()},{"./BasePopup":"BasePopup"}],CommandManager:[function(e,t,n){"use strict";var o;cc._RF.push(t,"13902eeZkJBX6dXAdIklUkk","CommandManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.CommandManager=n.CommandState=void 0,function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED",e[e.CANCELLED=3]="CANCELLED"}(o=n.CommandState||(n.CommandState={}));var r=function(){function e(){this._channels=new Map}return e.prototype.clearAll=function(){this._channels.forEach(function(e){e.queuedCommands=[],e.runningCommands.forEach(function(e){return e.cancel()}),e.runningCommands=[]}),this._channels.clear()},e.prototype.onUpdate=function(e){var t=this;this._channels.forEach(function(n,o){0!==n.queuedCommands.length||0!==n.runningCommands.length?t.processChannel(n,e):t._channels.delete(o)})},e.prototype.processChannel=function(e,t){if(e.runningCommands.length>0){for(var n=e.runningCommands.length-1;n>=0;n--)(r=e.runningCommands[n]).state===o.RUNNING&&r.update(t),r.state!==o.COMPLETED&&r.state!==o.CANCELLED||e.runningCommands.splice(n,1);if(e.runningCommands.length>0)return}if(e.queuedCommands.length>0){var r=e.queuedCommands.shift();this.executeCommand(e,r)}},e.prototype.executeCommand=function(e,t){e.runningCommands.push(t),t.execute()},e.prototype.skip=function(e){var t=this._channels.get(e);t&&t.runningCommands.length>0&&t.runningCommands.forEach(function(e){return e.cancel()})},e.prototype.runCommandChannel=function(e,t){var n=this;t.forEach(function(t){n.add(e,t)})},e.prototype.add=function(e,t,n){void 0===n&&(n=!1);var o=this.getChannelData(e);n?o.queuedCommands.unshift(t):o.queuedCommands.push(t)},e.prototype.getChannelData=function(e){return this._channels.has(e)||this._channels.set(e,{runningCommands:[],queuedCommands:[]}),this._channels.get(e)},e.prototype.clearChannel=function(e){if(this._channels.has(e)){var t=this._channels.get(e);t.queuedCommands=[],t.runningCommands.forEach(function(e){return e.cancel()}),t.runningCommands=[]}},e}();n.CommandManager=r,cc._RF.pop()},{}],Declaration:[function(e,t,n){"use strict";cc._RF.push(t,"fc758P4dYdNAZBytXGSnm6w","Declaration"),Object.defineProperty(n,"__esModule",{value:!0}),n.GLOBAL_EVENTS=n.RGPUtils=n.TweenService=n.StateMachine=n.BaseState=n.GlobalDataManager=n.GlobalEventManager=n.GameAssetsManager=n.GameApiManager=n.SoundManager=n.BaseScreen=void 0;var o=e("../game-libs/screen/BaseScreen");Object.defineProperty(n,"BaseScreen",{enumerable:!0,get:function(){return o.BaseScreen}});var r=e("../game-libs/sound/SoundManager");Object.defineProperty(n,"SoundManager",{enumerable:!0,get:function(){return r.SoundManager}});var i=e("../game-libs/network/GameApiManager");Object.defineProperty(n,"GameApiManager",{enumerable:!0,get:function(){return i.GameApiManager}});var s=e("./GameAssetsManager");Object.defineProperty(n,"GameAssetsManager",{enumerable:!0,get:function(){return s.GameAssetsManager}});var a=e("../game-libs/manager/GlobalEventManager");Object.defineProperty(n,"GlobalEventManager",{enumerable:!0,get:function(){return a.GlobalEventManager}});var c=e("../game-libs/manager/GlobalDataManager");Object.defineProperty(n,"GlobalDataManager",{enumerable:!0,get:function(){return c.GlobalDataManager}});var l=e("../game-libs/network/GameNetworkManager");n.default=l.default;var u=e("../game-libs/pattern/state-machine/BaseState");Object.defineProperty(n,"BaseState",{enumerable:!0,get:function(){return u.BaseState}});var p=e("../game-libs/pattern/state-machine/StateMachine");Object.defineProperty(n,"StateMachine",{enumerable:!0,get:function(){return p.StateMachine}});var h=e("../game-libs/utils/TweenService");Object.defineProperty(n,"TweenService",{enumerable:!0,get:function(){return h.TweenService}});var f=e("../game-libs/utils/RGPUtils");Object.defineProperty(n,"RGPUtils",{enumerable:!0,get:function(){return f.RGPUtils}});var d=e("./constants/EventsConstants");Object.defineProperty(n,"GLOBAL_EVENTS",{enumerable:!0,get:function(){return d.GLOBAL_EVENTS}}),cc._RF.pop()},{"../game-libs/manager/GlobalDataManager":"GlobalDataManager","../game-libs/manager/GlobalEventManager":"GlobalEventManager","../game-libs/network/GameApiManager":"GameApiManager","../game-libs/network/GameNetworkManager":"GameNetworkManager","../game-libs/pattern/state-machine/BaseState":"BaseState","../game-libs/pattern/state-machine/StateMachine":"StateMachine","../game-libs/screen/BaseScreen":"BaseScreen","../game-libs/sound/SoundManager":"SoundManager","../game-libs/utils/RGPUtils":"RGPUtils","../game-libs/utils/TweenService":"TweenService","./GameAssetsManager":"GameAssetsManager","./constants/EventsConstants":"EventsConstants"}],Emitter:[function(e,t,n){"use strict";cc._RF.push(t,"ddf49f7IRZEg6/AegBd3itm","Emitter"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){this.handlers=new Map}return e.prototype.on=function(e,t){var n=this;if(!e||"string"!=typeof e)return console.error("[Emitter] Invalid event name"),function(){};if(!t||"function"!=typeof t)return console.error("[Emitter] Invalid callback function"),function(){};try{var o=this.handlers.get(e);return o||(o=new Set,this.handlers.set(e,o)),o.add(t),function(){return n.off(e,t)}}catch(r){return console.error("[Emitter] Error in on():",r),function(){}}},e.prototype.off=function(e,t){if(e&&"string"==typeof e)try{if(!this.handlers.has(e))return;if(!t)return void this.handlers.delete(e);var n=this.handlers.get(e);n&&(n.delete(t),0===n.size&&this.handlers.delete(e))}catch(o){console.error("[Emitter] Error in off():",o)}else console.error("[Emitter] Invalid event name")},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e&&"string"==typeof e)try{var o=this.handlers.get(e);if(!o||0===o.size)return;var r=[];o.forEach(function(e){return r.push(e)});for(var i=0;i<r.length;i++){var s=r[i];try{s.apply(void 0,t)}catch(a){console.error('[Emitter] Error in "'+e+'" callback:',a)}}}catch(a){console.error("[Emitter] Error in emit():",a)}else console.error("[Emitter] Invalid event name")},e.prototype.clear=function(){try{this.handlers.clear()}catch(e){console.error("[Emitter] Error in clear():",e)}},e.prototype.listenerCount=function(e){if(!e||"string"!=typeof e)return 0;try{var t=this.handlers.get(e);return t?t.size:0}catch(n){return console.error("[Emitter] Error in listenerCount():",n),0}},e.prototype.eventNames=function(){try{var e=[];return this.handlers.forEach(function(t,n){e.push(n)}),e}catch(t){return console.error("[Emitter] Error in eventNames():",t),[]}},e.prototype.hasListeners=function(e){return this.listenerCount(e)>0},e.prototype.removeAllListeners=function(e){if(e&&"string"==typeof e)try{this.handlers.delete(e)}catch(t){console.error("[Emitter] Error in removeAllListeners():",t)}else console.error("[Emitter] Invalid event name")},Object.defineProperty(e.prototype,"totalListenerCount",{get:function(){try{var e=0;return this.handlers.forEach(function(t){e+=t.size}),e}catch(t){return console.error("[Emitter] Error in totalListenerCount():",t),0}},enumerable:!1,configurable:!0}),e}();n.default=o,cc._RF.pop()},{}],EnvironmentConfig:[function(e,t,n){"use strict";cc._RF.push(t,"00ed5+9bBRIC6NPKQOpPDLN","EnvironmentConfig");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.EnvironmentConfig=void 0;var i=e("../utils/AsyncUtils"),s=function(){function e(){this.configData=null,this.currentEnvironment=null}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.loadConfig=function(){return o(this,void 0,Promise,function(){var e,t,n,o;return r(this,function(r){switch(r.label){case 0:if(this.configData)return[2,this.configData];r.label=1;case 1:return r.trys.push([1,3,,4]),e=!1,t=null,n=null,cc.resources.load("config/server-environments",cc.JsonAsset,function(o,r){if(e=!0,o)return n=o,void console.error("[EnvironmentConfig] Failed to load config:",o.message);r&&(t=r.json)}),[4,i.waitUntil(function(){return e})];case 2:return r.sent(),n||!t?(console.error("[EnvironmentConfig] Failed to load environment config"),[2,null]):(this.configData=t,console.log("[EnvironmentConfig] Config loaded successfully",this.configData),[2,this.configData]);case 3:return o=r.sent(),console.error("[EnvironmentConfig] Error loading config:",o),[2,null];case 4:return[2]}})})},e.prototype.getEnvironments=function(){return this.configData?this.configData.environments:[]},e.prototype.getEnvironment=function(e){return this.getEnvironments().find(function(t){return t.name===e})||null},e.prototype.setCurrentEnvironment=function(e){this.currentEnvironment=e,console.log("[EnvironmentConfig] Current environment set to:",e.name)},e.prototype.getCurrentEnvironment=function(){return this.currentEnvironment},e.prototype.reset=function(){this.configData=null,this.currentEnvironment=null},e._instance=null,e}();n.EnvironmentConfig=s,cc._RF.pop()},{"../utils/AsyncUtils":"AsyncUtils"}],EventsConstants:[function(e,t,n){"use strict";cc._RF.push(t,"a50d7bdI5NNfI6faVHN6T2U","EventsConstants"),Object.defineProperty(n,"__esModule",{value:!0}),n.GLOBAL_EVENTS=void 0,n.GLOBAL_EVENTS={SPIN_LAST:"spin_last"},cc._RF.pop()},{}],GameApiManager:[function(e,t,n){"use strict";cc._RF.push(t,"032e5Tqja1JXbijb+HdBVNX","GameApiManager");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.GameApiManager=void 0;var i=e("./APIHandler"),s=e("./ApiURL"),a=e("./NetworkConfig"),c=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.getBalance=function(){return o(this,void 0,void 0,function(){var e,t;return r(this,function(n){switch(n.label){case 0:return e=a.NetworkConfig.instance.buildApiUrl(s.ApiURL.GET_BALANCE),[4,i.APIHandler.instance.get(e)];case 1:return(t=n.sent()).success&&(this.balance=t.data.balance),[2]}})})},e}();n.GameApiManager=c,cc._RF.pop()},{"./APIHandler":"APIHandler","./ApiURL":"ApiURL","./NetworkConfig":"NetworkConfig"}],GameAssetsManager:[function(e,t,n){"use strict";cc._RF.push(t,"1d9ec28lUVFxY0GyKpEm3Xk","GameAssetsManager");var o,r,i,s,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.GameAssetsManager=n.DEFINE_SPINE_SYMBOL_BY_CODE=n.DEFINE_SPRITE_FAKE_SYMBOL_BY_CODE=n.DEFINE_SPRITE_SYMBOL_BY_CODE=void 0;var l=e("./constants/GameConstants"),u=cc._decorator,p=u.ccclass,h=u.property;n.DEFINE_SPRITE_SYMBOL_BY_CODE=((r={})[l.ESlotSymbol.Farmer]="storyoffarmer_s1",r[l.ESlotSymbol.Watermelon]="storyoffarmer_s2",r[l.ESlotSymbol.Cabbage]="storyoffarmer_s3",r[l.ESlotSymbol.Corn]="storyoffarmer_s4",r[l.ESlotSymbol.Carrot]="storyoffarmer_s5",r[l.ESlotSymbol.Eggplant]="storyoffarmer_s6",r[l.ESlotSymbol.Tomato]="storyoffarmer_s7",r[l.ESlotSymbol.Scatter]="storyoffarmer_s8_en",r[l.ESlotSymbol.Seed]="storyoffarmer_s9",r),n.DEFINE_SPRITE_FAKE_SYMBOL_BY_CODE=((i={})[l.ESlotSymbol.Farmer]="storyoffarmer_s1",i[l.ESlotSymbol.Watermelon]="storyoffarmer_s2",i[l.ESlotSymbol.Cabbage]="storyoffarmer_s3",i[l.ESlotSymbol.Corn]="storyoffarmer_s4",i[l.ESlotSymbol.Carrot]="storyoffarmer_s5",i[l.ESlotSymbol.Eggplant]="storyoffarmer_s6",i[l.ESlotSymbol.Tomato]="storyoffarmer_s7",i[l.ESlotSymbol.Scatter]="storyoffarmer_s8_en",i[l.ESlotSymbol.Seed]="storyoffarmer_s9",i),n.DEFINE_SPINE_SYMBOL_BY_CODE=((s={})[l.ESlotSymbol.Farmer]="storyoffarmer_s1_anim",s[l.ESlotSymbol.Watermelon]="storyoffarmer_s2_anim",s[l.ESlotSymbol.Cabbage]="storyoffarmer_s3_anim",s[l.ESlotSymbol.Corn]="storyoffarmer_s4_anim",s[l.ESlotSymbol.Carrot]="storyoffarmer_s5_anim",s[l.ESlotSymbol.Eggplant]="storyoffarmer_s6_anim",s[l.ESlotSymbol.Tomato]="storyoffarmer_s7_anim",s[l.ESlotSymbol.Scatter]="storyoffarmer_s8_anim",s[l.ESlotSymbol.Seed]="storyoffarmer_s9_anim",s);var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listSymbols=[],t.listSymbolsFake=[],t.listSpine=[],t}var o;return a(t,e),o=t,Object.defineProperty(t,"Instance",{get:function(){return o._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o._instance=this},t.prototype.onDestroy=function(){o._instance===this&&(o._instance=null)},t.prototype.getSymbolByCode=function(e){var t=n.DEFINE_SPRITE_SYMBOL_BY_CODE[e];if(this.listSymbols&&0!==this.listSymbols.length){var o=this.listSymbols.find(function(e){return e.name===t});return o||cc.error("[GameAssetsManager] symbol not found",e,t),o}cc.warn("[GameAssetsManager] symbol list empty")},t.prototype.getFakeSymbolByCode=function(e){var t=n.DEFINE_SPRITE_FAKE_SYMBOL_BY_CODE[e];if(this.listSymbolsFake&&0!==this.listSymbolsFake.length){var o=this.listSymbolsFake.find(function(e){return e.name===t});return o||cc.error("[GameAssetsManager] fake symbol not found",e,t),o}cc.warn("[GameAssetsManager] fake symbol list empty")},t.prototype.getSpineByCode=function(e){var t=n.DEFINE_SPINE_SYMBOL_BY_CODE[e];if(this.listSpine&&0!==this.listSpine.length){var o=this.listSpine.find(function(e){return e.name===t});return o||cc.error("[GameAssetsManager] fake symbol not found",e,t),o}cc.warn("[GameAssetsManager] spine symbol list empty")},t._instance=null,c([h([cc.SpriteFrame])],t.prototype,"listSymbols",void 0),c([h([cc.SpriteFrame])],t.prototype,"listSymbolsFake",void 0),c([h([sp.SkeletonData])],t.prototype,"listSpine",void 0),o=c([p],t)}(cc.Component);n.GameAssetsManager=f,cc._RF.pop()},{"./constants/GameConstants":"GameConstants"}],GameConstants:[function(e,t,n){"use strict";var o,r,i;cc._RF.push(t,"b57eedRXDVHdbkbnbskZTnI","GameConstants"),Object.defineProperty(n,"__esModule",{value:!0}),n.SPEED_CONFIG=n.SlotSymbolMap=n.ESlotSymbol=n.ESlotId=void 0,function(e){e[e.Farmer=0]="Farmer",e[e.Watermelon=1]="Watermelon",e[e.Cabbage=2]="Cabbage",e[e.Corn=3]="Corn",e[e.Carrot=4]="Carrot",e[e.Eggplant=5]="Eggplant",e[e.Tomato=6]="Tomato",e[e.Scatter=7]="Scatter",e[e.Seed=8]="Seed"}(r=n.ESlotId||(n.ESlotId={})),function(e){e.Farmer="s1",e.Watermelon="s2",e.Cabbage="s3",e.Corn="s4",e.Carrot="s5",e.Eggplant="s6",e.Tomato="s7",e.Scatter="s8",e.Seed="s9"}(i=n.ESlotSymbol||(n.ESlotSymbol={})),n.SlotSymbolMap=((o={})[r.Farmer]=i.Farmer,o[r.Watermelon]=i.Watermelon,o[r.Cabbage]=i.Cabbage,o[r.Corn]=i.Corn,o[r.Carrot]=i.Carrot,o[r.Eggplant]=i.Eggplant,o[r.Tomato]=i.Tomato,o[r.Scatter]=i.Scatter,o[r.Seed]=i.Seed,o),n.SPEED_CONFIG={SPEED_NORMAL:4e3,SPEED_TURBO:6e3,SPEED_SLOW:3e3},cc._RF.pop()},{}],GameDataConfig:[function(e,t,n){"use strict";cc._RF.push(t,"c5652Sil5RLOpdyMvQMTudH","GameDataConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.EXECUTE_EVENT=void 0,n.EXECUTE_EVENT={START_SPIN:"start_spin",SHOW_RESULT:"show_result",COMPLETE_SPIN:"complete_spin",SKIP_REWARD:"skip_reward"},cc._RF.pop()},{}],GameDataType:[function(e,t,n){"use strict";cc._RF.push(t,"1333ajbINVK0rVC2wPG1AE3","GameDataType"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],GameDataWrapper:[function(e,t,n){"use strict";cc._RF.push(t,"04e2a36t/ZCZYZ6oNtpzX/A","GameDataWrapper"),Object.defineProperty(n,"__esModule",{value:!0}),n.GameDataWrapper=void 0;var o=e("./GameDataConfig"),r=function(){function e(){}return e.prototype.makeScriptExecuteSpin=function(){var e=[];return e.push({code:o.EXECUTE_EVENT.START_SPIN,data:{}}),e},e.prototype.makeScriptExecuteResult=function(e){var t=[];return t.push({code:o.EXECUTE_EVENT.SHOW_RESULT,data:this.parseDataResult(e)}),t},e.prototype.parseDataResult=function(e){var t=e.reelsMatrix,n=e.winMatrix,o=e.winCombinations&&e.winCombinations.length>0||Number(e.winAmount)>0,r=0;"string"==typeof e.winAmount?r=parseFloat(e.winAmount)||0:"number"==typeof e.winAmount&&(r=e.winAmount);var i=e.newBalance||0,s=(e.betAmount,{matrixResult:t,matrixWin:n,isWin:o,winAmount:r,isEndSession:"ENDED"===e.sessionStatus,newBalance:Number(i)});for(var a in s)null!=s[a]&&null!=s[a]||delete s[a];return s},e}();n.GameDataWrapper=r,cc._RF.pop()},{"./GameDataConfig":"GameDataConfig"}],GameNetworkManager:[function(e,t,n){"use strict";cc._RF.push(t,"38932pjsEJBd4FvYG9tcKUI","GameNetworkManager");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./WebSocketClient"),s=e("./NetworkConfig"),a=e("./NetworkConstants"),c=function(){function e(){this.isAuthenticated=!1,this.authToken="",this.isConnecting=!1,this.eventHandlerCleanups=[]}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){var t;return o(this,void 0,Promise,function(){var n,o;return r(this,function(r){switch(r.label){case 0:if(this.isConnecting)return console.warn("[GameNetworkManager] Connection already in progress"),[2];if(null===(t=this.client)||void 0===t?void 0:t.isConnected){if(this.authToken===e)return console.log("[GameNetworkManager] Already connected with same token"),[2];console.log("[GameNetworkManager] Reconnecting with new token"),this.disconnect()}this.isConnecting=!0,this.authToken=e,r.label=1;case 1:return r.trys.push([1,3,4,5]),n=this.buildWebSocketUrl(e),console.log("[GameNetworkManager] Connecting to WebSocket URL:",n.replace(/token=[^&]+/,"token=***")),this.client=new i.default({url:n,autoReconnect:!0,maxReconnectAttempts:10,reconnectDelay:1e3,maxReconnectDelay:3e4,heartbeatInterval:2e4,heartbeatTimeout:1e4,debug:!0,auth:{token:e}}),this.setupEventHandlers(),[4,this.client.connect()];case 2:return r.sent(),console.log("[GameNetworkManager] Connection established"),[3,5];case 3:throw o=r.sent(),console.error("[GameNetworkManager] Connection failed:",o),this.isAuthenticated=!1,this.client=void 0,o;case 4:return this.isConnecting=!1,[7];case 5:return[2]}})})},e.prototype.buildWebSocketUrl=function(e){try{return s.NetworkConfig.instance.buildWsUrl(e)}catch(t){return console.error("[GameNetworkManager] Error building WebSocket URL:",t),s.NetworkConfig.instance.getWsBaseUrl()+"?token="+encodeURIComponent(e)}},e.prototype.setupEventHandlers=function(){var e=this;if(this.client){this.cleanupEventHandlers();var t=[],n=function(n,o){var r=e.client.on(n,o);r&&t.push(r)};n("open",function(){console.log("[GameNetworkManager] Connection opened")}),n("close",function(t){console.log("[GameNetworkManager] Connection closed",t),e.isAuthenticated=!1}),n("error",function(e){console.error("[GameNetworkManager] Connection error",e)}),n("reconnecting",function(e){console.log("[GameNetworkManager] Reconnecting... attempt",e)}),n("reconnect_failed",function(){console.error("[GameNetworkManager] Reconnect failed"),e.isAuthenticated=!1}),n(a.EVENTS.AUTH_OK,function(t){console.log("[GameNetworkManager] Authentication successful",t.userId),e.isAuthenticated=!0}),n(a.EVENTS.AUTH_ERROR,function(t){console.error("[GameNetworkManager] Authentication failed",t.message),e.isAuthenticated=!1}),this.eventHandlerCleanups=t}},e.prototype.cleanupEventHandlers=function(){for(var e=0,t=this.eventHandlerCleanups;e<t.length;e++){var n=t[e];try{n()}catch(o){console.error("[GameNetworkManager] Error cleaning up event handler:",o)}}this.eventHandlerCleanups=[]},e.prototype.disconnect=function(){this.isConnecting=!1,this.isAuthenticated=!1,this.cleanupEventHandlers(),this.client&&(this.client.close(),this.client=void 0)},e.prototype.on=function(e,t){if(!this.client)return console.error("[GameNetworkManager] Client not initialized"),function(){};try{return this.client.on(e,t)||function(){}}catch(n){return console.error("[GameNetworkManager] Error subscribing to event:",e,n),function(){}}},e.prototype.off=function(e,t){if(this.client)try{this.client.off(e,t)}catch(n){console.error("[GameNetworkManager] Error unsubscribing from event:",e,n)}else console.error("[GameNetworkManager] Client not initialized")},e.prototype.emit=function(e,t){var n;(null===(n=this.client)||void 0===n?void 0:n.isConnected)?this.client.emit(e,t):console.error("[GameNetworkManager] Not connected")},e.prototype.request=function(e,t){var n;return o(this,void 0,Promise,function(){return r(this,function(){if(!(null===(n=this.client)||void 0===n?void 0:n.isConnected))throw new Error("Not connected to game server");return[2,this.client.request(e,t)]})})},Object.defineProperty(e.prototype,"isReady",{get:function(){var e;return!0===(null===(e=this.client)||void 0===e?void 0:e.isConnected)&&!0===this.isAuthenticated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnected",{get:function(){var e;return!0===(null===(e=this.client)||void 0===e?void 0:e.isConnected)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticated",{get:function(){return this.isAuthenticated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connecting",{get:function(){return this.isConnecting},enumerable:!1,configurable:!0}),e.prototype.setAuthToken=function(e){var t,n=null===(t=this.client)||void 0===t?void 0:t.isConnected;this.authToken=e,this.client&&(this.client.setAuthToken(e),n&&this.client.isConnected&&(console.log("[GameNetworkManager] Token updated, reconnecting..."),this.disconnect(),this.connect(e).catch(function(e){console.error("[GameNetworkManager] Failed to reconnect with new token:",e)})))},e.prototype.destroy=function(){this.disconnect(),this.authToken=""},e}();n.default=c,cc._RF.pop()},{"./NetworkConfig":"NetworkConfig","./NetworkConstants":"NetworkConstants","./WebSocketClient":"WebSocketClient"}],GenericPopup:[function(e,t,n){"use strict";cc._RF.push(t,"fbb3612s4BBtZvAjI34M29k","GenericPopup");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.GenericPopup=void 0;var s=e("./BasePopup"),a=cc._decorator,c=a.ccclass,l=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleLabel=null,t.contentLabel=null,t.confirmLabel=null,t.cancelLabel=null,t.confirmButton=null,t.cancelButton=null,t.headerNode=null,t.bodyNode=null,t.footerNode=null,t.titleContainer=null,t.onConfirmCallback=null,t.onCancelCallback=null,t}return r(t,e),t.prototype.setupUI=function(){e.prototype.setupUI.call(this),this.confirmButton&&this.confirmButton.node&&this.confirmButton.node.on("click",this.onConfirmClick,this),this.cancelButton&&this.cancelButton.node&&this.cancelButton.node.on("click",this.onCancelClick,this)},t.prototype.onDataReceived=function(t){if(e.prototype.onDataReceived.call(this,t),t){var n=t;void 0!==n.title&&(this.titleLabel&&(this.titleLabel.string=n.title||"",this.titleLabel.node.active=!!n.title),this.titleContainer&&(this.titleContainer.active=!!n.title),this.headerNode&&(this.headerNode.active=!!n.title)),void 0!==n.content&&this.contentLabel&&(this.contentLabel.string=n.content||"",this.contentLabel.node.active=!!n.content);var o=!1!==n.showConfirm,r=!0===n.showCancel;this.confirmButton&&(this.confirmButton.node.active=o,n.confirmText&&this.confirmLabel?this.confirmLabel.string=n.confirmText:this.confirmLabel&&(this.confirmLabel.string="OK")),this.cancelButton&&(this.cancelButton.node.active=r,n.cancelText&&this.cancelLabel?this.cancelLabel.string=n.cancelText:this.cancelLabel&&(this.cancelLabel.string="Cancel")),this.onConfirmCallback=n.onConfirm||null,this.onCancelCallback=n.onCancel||null}},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.cleanup=function(){e.prototype.cleanup.call(this),this.confirmButton&&this.confirmButton.node&&this.confirmButton.node.off("click",this.onConfirmClick,this),this.cancelButton&&this.cancelButton.node&&this.cancelButton.node.off("click",this.onCancelClick,this),this.onConfirmCallback=null,this.onCancelCallback=null},t.prototype.onConfirmClick=function(){this.onConfirmCallback&&this.onConfirmCallback(),this.deactive()},t.prototype.onCancelClick=function(){this.onCancelCallback&&this.onCancelCallback(),this.deactive()},i([l(cc.Label)],t.prototype,"titleLabel",void 0),i([l(cc.Label)],t.prototype,"contentLabel",void 0),i([l(cc.Label)],t.prototype,"confirmLabel",void 0),i([l(cc.Label)],t.prototype,"cancelLabel",void 0),i([l(cc.Button)],t.prototype,"confirmButton",void 0),i([l(cc.Button)],t.prototype,"cancelButton",void 0),i([l(cc.Node)],t.prototype,"headerNode",void 0),i([l(cc.Node)],t.prototype,"bodyNode",void 0),i([l(cc.Node)],t.prototype,"footerNode",void 0),i([l(cc.Node)],t.prototype,"titleContainer",void 0),i([c],t)}(s.BasePopup);n.GenericPopup=u,cc._RF.pop()},{"./BasePopup":"BasePopup"}],GlobalDataManager:[function(e,t,n){"use strict";cc._RF.push(t,"393cbrumJ5Bs7Ziwy3JJVu7","GlobalDataManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalDataManager=void 0;var s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mapDataStore=new Map,t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.onDestroy=function(){this.mapDataStore.clear(),n._instance===this&&(n._instance=null)},t.prototype.setDataStore=function(e,t){this.mapDataStore.set(e,t)},t.prototype.getDataStore=function(e,t){return this.mapDataStore.get(e)||t},t.prototype.setLocalStoreByKey=function(e,t){try{cc.sys.localStorage.setItem(e,t)}catch(n){console.error("[GlobalDataManager] Failed to save localStorage:",n)}},t.prototype.getLocalStoreByKey=function(e,t){void 0===t&&(t="");try{return cc.sys.localStorage.getItem(e)||t}catch(n){return console.error("[GlobalDataManager] Failed to read localStorage:",n),t}},t._instance=null,n=i([a],t)}(cc.Component));n.GlobalDataManager=c,cc._RF.pop()},{}],GlobalEventManager:[function(e,t,n){"use strict";cc._RF.push(t,"9bc61CZi15Fm5Xul2v/Ja5S","GlobalEventManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalEventManager=void 0;var a=cc._decorator.ccclass,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mapEventsRegistered=new Map,t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.onDestroy=function(){var e=this;n._instance===this&&(n._instance=null);for(var t=function(t,n){n.forEach(function(n){e.node.off(t,n.callback,n.target)})},o=0,r=this.mapEventsRegistered;o<r.length;o++){var i=r[o];t(i[0],i[1])}this.mapEventsRegistered.clear()},t.prototype.fireEvent=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(t=this.node).emit.apply(t,s([e],n))},t.prototype.registerEvents=function(e,t,n){var o=n||this;this.node.on(e,t,o),this.mapEventsRegistered.has(e)||this.mapEventsRegistered.set(e,[]),this.mapEventsRegistered.get(e).push({callback:t,target:o})},t.prototype.registerOnce=function(e,t,n){this.node.once(e,t,n||this)},t.prototype.unregisterEvents=function(e,t,n){var o=n||this;if(this.node.off(e,t,o),t&&this.mapEventsRegistered.has(e)){for(var r=this.mapEventsRegistered.get(e),i=r.length-1;i>=0;i--)r[i].callback===t&&r[i].target===o&&r.splice(i,1);0===r.length&&this.mapEventsRegistered.delete(e)}},t.prototype.unregisterAllByTarget=function(e){for(var t=0,n=this.mapEventsRegistered;t<n.length;t++){for(var o=n[t],r=o[0],i=o[1],s=i.length-1;s>=0;s--)i[s].target===e&&(this.node.off(r,i[s].callback,e),i.splice(s,1));0===i.length&&this.mapEventsRegistered.delete(r)}},t._instance=null,n=i([a],t)}(cc.Component);n.GlobalEventManager=c,cc._RF.pop()},{}],GlobalEvents:[function(e,t){"use strict";cc._RF.push(t,"30893b9hCFE/5Esb1/e/rxL","GlobalEvents"),cc._RF.pop()},{}],INoSleep:[function(e,t,n){"use strict";cc._RF.push(t,"0f8d4iG61tHJpAAshY3OE3Y","INoSleep"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],IOSNoSleep:[function(e,t,n){"use strict";cc._RF.push(t,"946c99YEj1Nj6g9uhlDHarU","IOSNoSleep");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.IOSNoSleep=void 0;var i=function(){function e(){this._isEnabled=!1}return e.prototype.startService=function(){return o(this,void 0,Promise,function(){return r(this,function(){return cc.sys.isNative&&cc.sys.os===cc.sys.OS_IOS?(cc.log("[IOSNoSleep] Starting NoSleep service for iOS"),[2]):(cc.warn("[IOSNoSleep] NoSleep only supports iOS platform."),[2])})})},e.prototype.enable=function(){cc.sys.isNative&&cc.sys.os===cc.sys.OS_IOS?this._isEnabled?cc.log("[IOSNoSleep] NoSleep is already enabled"):(cc.warn("[IOSNoSleep] TO DO IMPLEMENTATION FOR ENABLE NO SLEEP"),this._isEnabled=!0):cc.warn("[IOSNoSleep] NoSleep only supports iOS platform.")},e.prototype.disable=function(){this._isEnabled&&(cc.warn("[IOSNoSleep] TO DO IMPLEMENTATION FOR DISABLE NO SLEEP"),this._isEnabled=!1)},e.prototype.toggle=function(){this._isEnabled=!this._isEnabled,this._isEnabled?this.enable():this.disable()},e.prototype.isEnabled=function(){return this._isEnabled},e}();n.IOSNoSleep=i,cc._RF.pop()},{}],IdleState:[function(e,t,n){"use strict";cc._RF.push(t,"dd8eclXOIxBDKm3DGeEiaOt","IdleState");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.IdleState=void 0;var s=e("./SlotState"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onEnterState=function(){this.getStateMachine().btnSpin.active=!0,this.getStateMachine().btnSpin.getComponent(cc.Button).interactable=!0,this.getStateMachine().btnSpin.opacity=255},t.prototype.onExitState=function(){this.getStateMachine().btnSpin.getComponent(cc.Button).interactable=!1,this.getStateMachine().btnSpin.opacity=155},i([c],t)}(s.SlotState));n.IdleState=l,cc._RF.pop()},{"./SlotState":"SlotState"}],InterfaceTweenHub:[function(e,t,n){"use strict";cc._RF.push(t,"81314e9IqpCooap7ZKM41Ds","InterfaceTweenHub"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],LoadingOverlay:[function(e,t,n){"use strict";cc._RF.push(t,"fd151vhDbZKfpsDihux2zmM","LoadingOverlay");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.LoadingOverlay=n.LoadingMode=void 0;var s,a=cc._decorator,c=a.ccclass,l=a.property;(function(e){e.SIMPLE="simple",e.PROGRESS="progress"})(s=n.LoadingMode||(n.LoadingMode={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.simpleModeContainer=null,t.spinnerNode=null,t.simpleMessageLabel=null,t.progressModeContainer=null,t.progressBar=null,t.progressLabel=null,t.progressMessageLabel=null,t.block=null,t.timeoutId=null,t.cacheLoadingText="",t.cooldownStartValue=0,t.countingUp=!0,t.clamp0=!0,t.isCooldownActive=!1,t.isLoopingActive=!1,t.currentMode=s.SIMPLE,t.currentProgress=0,t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){n._instance=this,this.node.scale=1,this.block=this.node.getComponent(cc.BlockInputEvents),this.block||(this.block=this.node.addComponent(cc.BlockInputEvents)),this.setMode(s.SIMPLE),this.iHide(),console.log("[LoadingOverlay] <onLoad> LoadingOverlay initialized")},t.prototype.onDestroy=function(){this.cleanup(),n._instance===this&&(n._instance=null)},t.prototype.cleanup=function(){this.unscheduleAll(),this.clearTimeout(),this.isCooldownActive=!1,this.isLoopingActive=!1},t.prototype.clearTimeout=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)},t.prototype.unscheduleAll=function(){this.unschedule(this.cooldown),this.unschedule(this.loopingText)},t.prototype.setMode=function(e){this.currentMode=e,this.simpleModeContainer&&(this.simpleModeContainer.active=e===s.SIMPLE),this.progressModeContainer&&(this.progressModeContainer.active=e===s.PROGRESS),e===s.PROGRESS&&this.progressBar&&(this.progressBar.progress=0,this.currentProgress=0)},t.prototype.iShow=function(){this.node.active=!0,this.block&&(this.block.enabled=!0),this.simpleMessageLabel&&(this.simpleMessageLabel.string=""),this.progressMessageLabel&&(this.progressMessageLabel.string="")},t.prototype.iHide=function(){this.node.active=!1,this.block&&(this.block.enabled=!1),this.unscheduleAll(),this.clearTimeout(),this.currentProgress=0,this.progressBar&&(this.progressBar.progress=0),this.progressLabel&&(this.progressLabel.string="0%")},t.setMode=function(e){var t=n._instance;t?t.setMode(e):console.warn("[LoadingOverlay] Instance not initialized yet")},t.setActiveLoadingText=function(e){var t=n._instance;t?t.spinnerNode&&(t.spinnerNode.active=e):console.warn("[LoadingOverlay] Instance not initialized yet")},t.setProgress=function(e){var t=n._instance;t?(t.currentProgress=Math.max(0,Math.min(1,e)),t.progressBar&&(t.progressBar.progress=t.currentProgress),t.progressLabel&&(t.progressLabel.string=Math.round(100*t.currentProgress)+"%")):console.warn("[LoadingOverlay] Instance not initialized yet")},t.setMessage=function(e){var t=n._instance;t?t.currentMode===s.SIMPLE?t.simpleMessageLabel&&(t.simpleMessageLabel.string=e||""):t.progressMessageLabel&&(t.progressMessageLabel.string=e||""):console.warn("[LoadingOverlay] Instance not initialized yet")},t.show=function(e,t){void 0===e&&(e=s.SIMPLE);var o=n._instance;o?(o.setMode(e),t&&n.setMessage(t),o.iShow(),n.setActiveLoadingText(e===s.SIMPLE)):console.warn("[LoadingOverlay] Instance not initialized yet")},t.hide=function(){var e=n._instance;e?e.iHide():console.warn("[LoadingOverlay] Instance not initialized yet")},t.showWithTimeout=function(e,t,o){void 0===o&&(o=s.SIMPLE);var r=n._instance;if(!r)return console.warn("[LoadingOverlay] Instance not initialized yet"),void(t&&t());n.show(o),r.clearTimeout(),r.timeoutId=setTimeout(function(){n.hide();var e=n._instance;e&&(e.timeoutId=null),t&&t()},e)},t.setCooldownText=function(e,t,o,r){void 0===o&&(o=!0),void 0===r&&(r=!0);var i=n._instance;i?(i.unschedule(i.cooldown),i.isCooldownActive=!1,i.cacheLoadingText=e,i.countingUp=o,i.cooldownStartValue=t,i.clamp0=r,i.isCooldownActive=!0,i.cooldown(),i.schedule(i.cooldown,1)):console.warn("[LoadingOverlay] Instance not initialized yet")},t.stopCooldown=function(){var e=n._instance;e&&(e.unschedule(e.cooldown),e.isCooldownActive=!1)},t.prototype.cooldown=function(){if(this.isCooldownActive){var e="";this.currentMode===s.SIMPLE&&this.simpleMessageLabel?(e=this.cacheLoadingText.replace("{value}",this.cooldownStartValue.toString()),this.simpleMessageLabel.string=e):this.currentMode===s.PROGRESS&&this.progressMessageLabel&&(e=this.cacheLoadingText.replace("{value}",this.cooldownStartValue.toString()),this.progressMessageLabel.string=e),this.cooldownStartValue+=this.countingUp?1:-1,this.cooldownStartValue<0&&this.clamp0&&(this.cooldownStartValue=0)}},t.setLoopingProgressText=function(e,t){void 0===t&&(t=!0);var o=n._instance;o?(o.unschedule(o.loopingText),o.isLoopingActive=!1,o.cacheLoadingText=e,o.currentMode===s.SIMPLE&&o.simpleMessageLabel?o.simpleMessageLabel.string=e:o.currentMode===s.PROGRESS&&o.progressMessageLabel&&(o.progressMessageLabel.string=e),t&&(o.isLoopingActive=!0,o.schedule(o.loopingText,.3),console.log("[LoadingOverlay] Looping text scheduled:",e))):console.warn("[LoadingOverlay] Instance not initialized yet")},t.stopLooping=function(){var e=n._instance;e&&(e.unschedule(e.loopingText),e.isLoopingActive=!1)},t.prototype.loopingText=function(){if(this.isLoopingActive){var e="";this.currentMode===s.SIMPLE&&this.simpleMessageLabel?e=this.simpleMessageLabel.string:this.currentMode===s.PROGRESS&&this.progressMessageLabel&&(e=this.progressMessageLabel.string);var t=e.replace(/\.+$/,"");t||(t=this.cacheLoadingText);var n,o=e.length-t.length;n=o>=3?t:t+".".repeat(o+1),this.currentMode===s.SIMPLE&&this.simpleMessageLabel?this.simpleMessageLabel.string=n:this.currentMode===s.PROGRESS&&this.progressMessageLabel&&(this.progressMessageLabel.string=n)}else console.log("[LoadingOverlay] Looping inactive, stopping")},t.getCurrentMode=function(){var e=n._instance;return e?e.currentMode:s.SIMPLE},t.getProgress=function(){var e=n._instance;return e?e.currentProgress:0},t._instance=null,i([l(cc.Node)],t.prototype,"simpleModeContainer",void 0),i([l(cc.Node)],t.prototype,"spinnerNode",void 0),i([l(cc.Label)],t.prototype,"simpleMessageLabel",void 0),i([l(cc.Node)],t.prototype,"progressModeContainer",void 0),i([l(cc.ProgressBar)],t.prototype,"progressBar",void 0),i([l(cc.Label)],t.prototype,"progressLabel",void 0),i([l(cc.Label)],t.prototype,"progressMessageLabel",void 0),n=i([c],t)}(cc.Component);n.LoadingOverlay=u,cc._RF.pop()},{}],Logger:[function(e,t,n){"use strict";cc._RF.push(t,"7426cdG0sxIxI/4G2PldvRc","Logger");var o,r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.Logger=n.LogLevel=void 0,function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.NONE=4]="NONE"}(o=n.LogLevel||(n.LogLevel={}));var i=function(){function e(e,t){void 0===e&&(e="NetworkClient"),void 0===t&&(t=o.INFO),this.prefix=e,this.level=t}return e.prototype.setLevel=function(e){this.level=e},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=o.DEBUG&&console.debug.apply(console,r(["["+this.prefix+"]"],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=o.INFO&&console.log.apply(console,r(["["+this.prefix+"]"],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=o.WARN&&console.warn.apply(console,r(["["+this.prefix+"]"],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=o.ERROR&&console.error.apply(console,r(["["+this.prefix+"]"],e))},e}();n.Logger=i,cc._RF.pop()},{}],LoginManager:[function(e,t,n){"use strict";cc._RF.push(t,"981afE3IKdBo6kHJGXrfiHM","LoginManager");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.LoginManager=void 0;var i=e("../network/APIHandler"),s=e("../network/ApiURL"),a=e("../network/NetworkConfig"),c=function(){function e(){this.restoreSession()}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.login=function(e){return o(this,void 0,Promise,function(){var t,n;return r(this,function(o){switch(o.label){case 0:return t=a.NetworkConfig.instance.buildApiUrl(s.ApiURL.POST_LOGIN),[4,i.APIHandler.instance.post(e,t)];case 1:if(!(n=o.sent()))throw new Error("Network error: No response from server. Please check your connection.");if("object"!=typeof n)throw new Error("Invalid response format from server");return this.saveTokens(n,e.rememberMe),console.log("<LoginManager> login response "+JSON.stringify(n)),[2,n]}})})},e.prototype.register=function(e){return o(this,void 0,Promise,function(){var t,n;return r(this,function(o){switch(o.label){case 0:return t=a.NetworkConfig.instance.buildApiUrl(s.ApiURL.POST_REGISTER),[4,i.APIHandler.instance.post(e,t)];case 1:if(!(n=o.sent()))throw new Error("Network error: No response from server. Please check your connection.");if("object"!=typeof n)throw new Error("Invalid response format from server");return this.saveTokens(n),[2,n]}})})},e.prototype.saveTokens=function(e,t){if(void 0===t&&(t=!0),e&&e.success&&e.data){var n=e.data,o=n.accessToken,r=n.refreshToken,s=n.expiresIn,a=n.user;i.APIHandler.instance.jwt=o,t?this.persistTokens(o,r,s,a):(this.clearSession(),i.APIHandler.instance.jwt=o)}},e.prototype.getAccessToken=function(){return i.APIHandler.instance.jwt},e.prototype.clearSession=function(){localStorage.removeItem(e.ACCESS_TOKEN_KEY),localStorage.removeItem(e.REFRESH_TOKEN_KEY),localStorage.removeItem(e.EXPIRES_IN_KEY),localStorage.removeItem(e.USER_INFO_KEY),localStorage.removeItem("auth.expirationTimestamp"),localStorage.removeItem("auth.savedTime")},e.prototype.restoreSession=function(){var t=localStorage.getItem(e.ACCESS_TOKEN_KEY)||"";t&&(i.APIHandler.instance.jwt=t)},e.prototype.persistTokens=function(t,n,o,r){localStorage.setItem(e.ACCESS_TOKEN_KEY,t),localStorage.setItem(e.REFRESH_TOKEN_KEY,n),localStorage.setItem(e.EXPIRES_IN_KEY,o),localStorage.setItem(e.USER_INFO_KEY,JSON.stringify(r));var i=parseInt(o,10);if(!isNaN(i)){var s=Date.now()+1e3*i;localStorage.setItem("auth.expirationTimestamp",s.toString()),localStorage.setItem("auth.savedTime",Date.now().toString())}},e.prototype.isTokenExpired=function(){var e=localStorage.getItem("auth.expirationTimestamp");if(!e)return!0;var t=parseInt(e,10);return!!isNaN(t)||Date.now()>=t-864e5},e.prototype.isAuthenticated=function(){var e=this.getAccessToken();return!(!e||""===e.trim()||this.isTokenExpired())},e.prototype.logout=function(){this.clearSession(),i.APIHandler.instance.jwt=""},e.prototype.refreshToken=function(){return o(this,void 0,Promise,function(){var t,n,o,c,l,u,p,h,f;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(t=localStorage.getItem(e.REFRESH_TOKEN_KEY)||"")?(n=a.NetworkConfig.instance.buildApiUrl(s.ApiURL.POST_REFRESH_TOKEN),[4,i.APIHandler.instance.post({refreshToken:t},n,3)]):[2,!1];case 1:return(o=r.sent())&&o.success&&o.data?(c=o.data,l=c.accessToken,u=c.refreshToken,p=c.expiresIn,h=c.user,i.APIHandler.instance.jwt=l,this.persistTokens(l,u,p,h),[2,!0]):[3,3];case 2:return f=r.sent(),console.log("Refresh token error",f),[3,3];case 3:return this.logout(),[2,!1]}})})},e.ACCESS_TOKEN_KEY="auth.accessToken",e.REFRESH_TOKEN_KEY="auth.refreshToken",e.EXPIRES_IN_KEY="auth.expiresIn",e.USER_INFO_KEY="auth.user",e}();n.LoginManager=c,cc._RF.pop()},{"../network/APIHandler":"APIHandler","../network/ApiURL":"ApiURL","../network/NetworkConfig":"NetworkConfig"}],LoginScreen:[function(e,t,n){"use strict";cc._RF.push(t,"a2be7ABXh9PIpO4QaU+znif","LoginScreen");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.LoginScreen=void 0;var c,l=cc._decorator,u=l.ccclass,p=l.property,h=e("../screen/index"),f=e("../screen/BaseScreen"),d=e("./LoginManager"),y=e("../network/GameApiManager"),g=e("../network/GameNetworkManager"),m=e("../network/APIHandler"),v=e("../popup/PopupConfig"),b=e("../popup/PopupManager"),S=e("../popup/LoadingOverlay");(function(e){e.LOGIN="login",e.REGISTER="register"})(c||(c={}));var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggleLogin=null,t.toggleRegister=null,t.inputName=null,t.inputEmail=null,t.inputPassword=null,t.btnSubmit=null,t.btnSubmitLabel=null,t.nameContainer=null,t.currentMode=c.LOGIN,t.isProcessing=!1,t}return r(t,e),t.prototype.setupUI=function(){e.prototype.setupUI.call(this),this.toggleLogin&&this.toggleLogin.node&&this.toggleLogin.node.on("toggle",this.onModeToggle,this),this.toggleRegister&&this.toggleRegister.node&&this.toggleRegister.node.on("toggle",this.onModeToggle,this),this.btnSubmit&&this.btnSubmit.node&&this.btnSubmit.node.on("click",this.onSubmit,this),this.loadSavedCredentials(),this.setMode(c.LOGIN)},t.prototype.onDataReceived=function(t){e.prototype.onDataReceived.call(this,t),(null==t?void 0:t.email)&&this.inputEmail&&(this.inputEmail.string=t.email),(null==t?void 0:t.mode)===c.REGISTER&&this.setMode(c.REGISTER)},t.prototype.onShow=function(){e.prototype.onShow.call(this),this.loadSavedCredentials()},t.prototype.onHide=function(){e.prototype.onHide.call(this),this.saveCredentials()},t.prototype.cleanup=function(){e.prototype.cleanup.call(this),this.toggleLogin&&this.toggleLogin.node&&this.toggleLogin.node.off("toggle",this.onModeToggle,this),this.toggleRegister&&this.toggleRegister.node&&this.toggleRegister.node.off("toggle",this.onModeToggle,this),this.btnSubmit&&this.btnSubmit.node&&this.btnSubmit.node.off("click",this.onSubmit,this)},t.prototype.onModeToggle=function(e){e.isChecked&&(e===this.toggleLogin?this.setMode(c.LOGIN):e===this.toggleRegister&&this.setMode(c.REGISTER))},t.prototype.setMode=function(e){this.currentMode=e,this.toggleLogin&&(this.toggleLogin.isChecked=e===c.LOGIN),this.toggleRegister&&(this.toggleRegister.isChecked=e===c.REGISTER),this.nameContainer&&(this.nameContainer.active=e===c.REGISTER),this.btnSubmitLabel&&(this.btnSubmitLabel.string=e===c.LOGIN?"Login":"Register"),e===c.LOGIN&&this.inputPassword&&(this.inputPassword.string="")},t.prototype.onSubmit=function(){return s(this,void 0,Promise,function(){var e;return a(this,function(t){switch(t.label){case 0:if(this.isProcessing)return[2];if(!this.validateInputs())return[2];this.isProcessing=!0,this.setButtonsEnabled(!1),S.LoadingOverlay.show(S.LoadingMode.SIMPLE,"Processing..."),S.LoadingOverlay.setLoopingProgressText("Processing..."),t.label=1;case 1:return t.trys.push([1,6,7,8]),this.currentMode!==c.LOGIN?[3,3]:[4,this.performLogin()];case 2:return t.sent(),[3,5];case 3:return[4,this.performRegister()];case 4:t.sent(),t.label=5;case 5:return[3,8];case 6:return e=t.sent(),S.LoadingOverlay.hide(),this.showError(e instanceof Error?e.message:"An unexpected error occurred"),[3,8];case 7:return this.isProcessing=!1,this.setButtonsEnabled(!0),S.LoadingOverlay.hide(),[7];case 8:return[2]}})})},t.prototype.performLogin=function(){var e,t;return s(this,void 0,Promise,function(){var n,o,r,i;return a(this,function(s){switch(s.label){case 0:return n=(null===(e=this.inputEmail)||void 0===e?void 0:e.string.trim())||"",o=(null===(t=this.inputPassword)||void 0===t?void 0:t.string)||"",r={emailOrUsername:n,password:o,rememberMe:!0},[4,d.LoginManager.instance.login(r)];case 1:return(i=s.sent())?[3,2]:(this.showError("Network error: No response from server. Please check your connection."),[3,5]);case 2:return i.success?[4,this.onAuthSuccess()]:[3,4];case 3:return s.sent(),[3,5];case 4:this.showError(i.message||"Login failed"),s.label=5;case 5:return[2]}})})},t.prototype.performRegister=function(){var e,t,n;return s(this,void 0,Promise,function(){var o,r,i,s,c,l;return a(this,function(a){switch(a.label){case 0:return o=(null===(e=this.inputName)||void 0===e?void 0:e.string.trim())||"",r=(null===(t=this.inputEmail)||void 0===t?void 0:t.string.trim())||"",i=o,(s=(null===(n=this.inputPassword)||void 0===n?void 0:n.string)||"").length<6?(this.showError("Password must be at least 6 characters"),[2]):(c={name:o,email:r,username:i,password:s,confirmPassword:s,acceptTerms:!0},[4,d.LoginManager.instance.register(c)]);case 1:if(!(l=a.sent()))throw new Error("Network error: No response from server. Please check your connection.");return l.success?[4,this.onAuthSuccess()]:[3,3];case 2:return a.sent(),[3,4];case 3:this.showError(l.message||"Registration failed"),a.label=4;case 4:return[2]}})})},t.prototype.onAuthSuccess=function(){var e;return s(this,void 0,Promise,function(){var t;return a(this,function(n){switch(n.label){case 0:this.saveCredentials(),n.label=1;case 1:return n.trys.push([1,5,,6]),[4,y.GameApiManager.instance.getBalance()];case 2:return n.sent(),[4,g.default.instance.connect(m.APIHandler.instance.jwt)];case 3:return n.sent(),[4,null===(e=h.ScreenManager.Instance)||void 0===e?void 0:e.showScreen(h.ScreenType.MAIN)];case 4:return n.sent(),[3,6];case 5:return t=n.sent(),console.error("[LoginScreen] Error initializing game:",t),this.showError("Login successful but failed to initialize game. Please try again."),this.setButtonsEnabled(!0),this.isProcessing=!1,[3,6];case 6:return[2]}})})},t.prototype.validateInputs=function(){var e,t,n,o=(null===(e=this.inputEmail)||void 0===e?void 0:e.string.trim())||"",r=(null===(t=this.inputPassword)||void 0===t?void 0:t.string)||"";return o?this.validateEmail(o)?r?!(this.currentMode===c.REGISTER&&(null===(n=this.inputName)||void 0===n||!n.string.trim()))||(this.showError("Name is required"),!1):(this.showError("Password is required"),!1):(this.showError("Please enter a valid email address"),!1):(this.showError("Email is required"),!1)},t.prototype.validateEmail=function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},t.prototype.showError=function(e){var t;null===(t=b.PopupManager.Instance)||void 0===t||t.showPopup(v.PopupType.GENERIC_POPUP,{content:e,confirmText:"OK"})},t.prototype.setButtonsEnabled=function(e){this.btnSubmit&&(this.btnSubmit.interactable=e),this.toggleLogin&&(this.toggleLogin.interactable=e),this.toggleRegister&&(this.toggleRegister.interactable=e)},t.prototype.loadSavedCredentials=function(){if(cc.sys){var e=cc.sys.localStorage.getItem("email"),t=cc.sys.localStorage.getItem("username");e&&this.inputEmail&&(this.inputEmail.string=e),t&&this.inputName&&(this.inputName.string=t)}},t.prototype.saveCredentials=function(){var e,t;cc.sys&&((null===(e=this.inputEmail)||void 0===e?void 0:e.string)&&cc.sys.localStorage.setItem("email",this.inputEmail.string),(null===(t=this.inputName)||void 0===t?void 0:t.string)&&cc.sys.localStorage.setItem("username",this.inputName.string))},i([p(cc.Toggle)],t.prototype,"toggleLogin",void 0),i([p(cc.Toggle)],t.prototype,"toggleRegister",void 0),i([p(cc.EditBox)],t.prototype,"inputName",void 0),i([p(cc.EditBox)],t.prototype,"inputEmail",void 0),i([p(cc.EditBox)],t.prototype,"inputPassword",void 0),i([p(cc.Button)],t.prototype,"btnSubmit",void 0),i([p(cc.Label)],t.prototype,"btnSubmitLabel",void 0),i([p(cc.Node)],t.prototype,"nameContainer",void 0),i([u],t)}(f.BaseScreen);n.LoginScreen=_,cc._RF.pop()},{"../network/APIHandler":"APIHandler","../network/GameApiManager":"GameApiManager","../network/GameNetworkManager":"GameNetworkManager","../popup/LoadingOverlay":"LoadingOverlay","../popup/PopupConfig":"PopupConfig","../popup/PopupManager":"PopupManager","../screen/BaseScreen":"BaseScreen","../screen/index":void 0,"./LoginManager":"LoginManager"}],MainScreen:[function(e,t,n){"use strict";cc._RF.push(t,"99b87tBxsRJy6K9cpF3GoSp","MainScreen");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.MainScreen=void 0;var s=e("./Declaration"),a=cc._decorator.ccclass,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),i([a],t)}(s.BaseScreen);n.MainScreen=c,cc._RF.pop()},{"./Declaration":"Declaration"}],MockApi:[function(e,t,n){"use strict";cc._RF.push(t,"e327fW7m4RIlI5x5gs/VAFs","MockApi");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.MockApi=void 0;var a=cc._decorator,c=a.ccclass,l=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mockData=null,t.dataNormal=[],t}var n;return r(t,e),n=t,t.prototype.onLoad=function(){n.instance=this},t.prototype.initMock=function(){0==this.dataNormal.length&&(this.dataNormal=s(this.mockData.json.NORMAL_DATA))},t.prototype.getMocApikData=function(){return this.initMock(),this.getNormalData()},t.prototype.getNormalData=function(){var e=Math.floor(Math.random()*this.dataNormal.length);return this.dataNormal[e]},t.instance=null,i([l(cc.JsonAsset)],t.prototype,"mockData",void 0),n=i([c],t)}(cc.Component);n.MockApi=u,cc._RF.pop()},{}],NetworkConfig:[function(e,t,n){"use strict";cc._RF.push(t,"08de3JPsE5GG5jCKilKL8Qb","NetworkConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.NetworkConfig=void 0;var o=function(){function e(){this.apiBaseUrl="https://slot-stag.osyamazakiglobel.club/api",this.wsBaseUrl="wss://slot-stag.osyamazakiglobel.club/game"}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.setApiBaseUrl=function(e){this.apiBaseUrl=e,console.log("[NetworkConfig] API base URL updated to:",e)},e.prototype.setWsBaseUrl=function(e){this.wsBaseUrl=e,console.log("[NetworkConfig] WebSocket base URL updated to:",e)},e.prototype.getApiBaseUrl=function(){return this.apiBaseUrl},e.prototype.getWsBaseUrl=function(){return this.wsBaseUrl},e.prototype.buildApiUrl=function(e){return""+this.apiBaseUrl+e},e.prototype.buildWsUrl=function(e){var t=this.wsBaseUrl,n=-1!==t.indexOf("?")?"&":"?";return""+t+n+"token="+encodeURIComponent(e)},e._instance=null,e}();n.NetworkConfig=o,cc._RF.pop()},{}],NetworkConstants:[function(e,t,n){"use strict";cc._RF.push(t,"a1cb1K+SMFAQLmf0RMvOosK","NetworkConstants"),Object.defineProperty(n,"__esModule",{value:!0}),n.EVENTS=void 0,n.EVENTS={AUTH_OK:"auth.ok",AUTH_ERROR:"auth.error"},cc._RF.pop()},{}],NetworkTypes:[function(e,t,n){"use strict";cc._RF.push(t,"a8b493LfZ5Av4mpjT8RWCLV","NetworkTypes"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],NoSleepFactory:[function(e,t,n){"use strict";cc._RF.push(t,"3ffd8pGqZtJV5mPi+4BuLl0","NoSleepFactory"),Object.defineProperty(n,"__esModule",{value:!0}),n.NoSleepFactory=void 0;var o=e("./WebNoSleep"),r=e("./IOSNoSleep"),i=e("./AndroidNoSleep"),s=function(){function e(){}return e.create=function(){if(cc.sys.isBrowser)return new o.WebNoSleep;if(cc.sys.isNative){if(cc.sys.os===cc.sys.OS_IOS)return new r.IOSNoSleep;if(cc.sys.os===cc.sys.OS_ANDROID)return new i.AndroidNoSleep}return new o.WebNoSleep},e}();n.NoSleepFactory=s,cc._RF.pop()},{"./AndroidNoSleep":"AndroidNoSleep","./IOSNoSleep":"IOSNoSleep","./WebNoSleep":"WebNoSleep"}],PopupConfig:[function(e,t,n){"use strict";cc._RF.push(t,"520bcKy2tFH0pcEdvtLZSdh","PopupConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.PopupType=n.PATH_PREFAB_POPUP=void 0,n.PATH_PREFAB_POPUP="prefabs/popups/",function(e){e.GENERIC_POPUP="GenericPopup",e.OUT_OF_MONEY="OutOfMoney",e.DISCONNECT="Disconnect",e.SELECT_SERVER="SelectServerPopup"}(n.PopupType||(n.PopupType={})),cc._RF.pop()},{}],PopupData:[function(e,t,n){"use strict";cc._RF.push(t,"9325athB5pJ0LwV4gZp0xst","PopupData");var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.PopupStorage=n.PopupAnimationData=void 0;var r=cc._decorator,i=r.ccclass,s=r.property,a=function(){function e(){this.time=.2,this.scale=new cc.Vec2(1,1)}return o([s(cc.Float)],e.prototype,"time",void 0),o([s(cc.Vec2)],e.prototype,"scale",void 0),o([i("PopupAnimationData")],e)}();n.PopupAnimationData=a,function(e){e[e.CACHE=0]="CACHE",e[e.POOL=1]="POOL",e[e.DESTROY=2]="DESTROY"}(n.PopupStorage||(n.PopupStorage={})),cc._RF.pop()},{}],PopupManager:[function(e,t,n){"use strict";cc._RF.push(t,"9c53ccFmspH7JOmNeuSI3dm","PopupManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.PopupManager=void 0;var c=cc._decorator,l=c.ccclass,u=c.property,p=e("./PopupConfig"),h=e("./BasePopup"),f=e("./PopupData"),d=e("../utils/AsyncUtils"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popupContainer=null,t.caches=new Map,t.pools=new Map,t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance||console.error("[PopupManager] Instance not exists"),n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){n._instance=this,this.validateSetup()},t.prototype.onDestroy=function(){n._instance===this&&(n._instance=null),this.clearAll()},t.prototype.validateSetup=function(){this.popupContainer||console.error("[PopupManager] PopupContainer is not assigned")},t.prototype.showPopup=function(e,t,n,o){return void 0===n&&(n=!0),void 0===o&&(o=!1),s(this,void 0,Promise,function(){var r,i,s,c;return a(this,function(a){switch(a.label){case 0:if(!this.popupContainer)return console.error("[PopupManager] PopupContainer not assigned"),[2,null];if(n&&this.deactivateAllPopups(e),o&&this.deactivateAllPopups(),this.pools.has(e)){if(r=this.pools.get(e),c=r.getComponent(h.BasePopup))return r.active=!0,c.setup(t),[2,r];console.error("[PopupManager] Pooled popup missing BasePopup component: "+e),this.pools.delete(e)}if(this.caches.has(e)){if(i=this.caches.get(e),s=cc.instantiate(i),this.popupContainer.addChild(s),c=s.getComponent(h.BasePopup))return c.setup(t),this.savePopup(c,i),[2,s];console.error("[PopupManager] Cached popup missing BasePopup component: "+e),s.destroy()}return[4,this.loadAndShowPopup(e,t)];case 1:return[2,a.sent()]}})})},t.prototype.loadAndShowPopup=function(e,t){return s(this,void 0,Promise,function(){var n,o,r,i,s,c;return a(this,function(a){switch(a.label){case 0:return n=p.PATH_PREFAB_POPUP+e.toString(),o=!1,r=null,i=null,cc.resources.load(n,cc.Prefab,function(e,t){if(o=!0,e)return i=e,void console.error("[PopupManager] Failed to load prefab: "+n,e.message);r=t}),[4,d.waitUntil(function(){return o})];case 1:return a.sent(),i||!r?[2,null]:(s=cc.instantiate(r),this.popupContainer.addChild(s),(c=s.getComponent(h.BasePopup))?(c.setup(t),this.savePopup(c,r),[2,s]):(console.error("[PopupManager] Prefab missing BasePopup component: "+e),s.destroy(),[2,null]))}})})},t.prototype.savePopup=function(e,t){switch(e.storage){case f.PopupStorage.CACHE:this.caches.set(e.type,t);break;case f.PopupStorage.POOL:this.pools.set(e.type,e.node);break;case f.PopupStorage.DESTROY:}},t.prototype.deactivateAllPopups=function(e){if(void 0===e&&(e=null),this.popupContainer)for(var t=0,n=this.popupContainer.children;t<n.length;t++){var o=n[t],r=o.getComponent(h.BasePopup);null!=e&&e!=r.type||(r?r.deactive():o.active=!1)}},t.prototype.hidePopup=function(e){if(this.pools.has(e)){var t=this.pools.get(e);(r=t.getComponent(h.BasePopup))?r.deactive():t.active=!1}if(this.popupContainer)for(var n=0,o=this.popupContainer.children;n<o.length;n++){var r,i=o[n];if((r=i.getComponent(h.BasePopup))&&r.type===e&&i.active){r.deactive();break}}},t.prototype.isPopupActive=function(e){if(this.pools.has(e))return this.pools.get(e).active;if(this.popupContainer)for(var t=0,n=this.popupContainer.children;t<n.length;t++){var o=n[t],r=o.getComponent(h.BasePopup);if(r&&r.type===e&&o.active)return!0}return!1},t.prototype.getActivePopups=function(){var e=[];if(this.popupContainer)for(var t=0,n=this.popupContainer.children;t<n.length;t++){var o=n[t];if(o.active){var r=o.getComponent(h.BasePopup);r&&e.push(r)}}return e},t.prototype.clearAll=function(){this.caches.clear(),this.pools.clear()},t.prototype.clearPopup=function(e){this.caches.delete(e),this.pools.delete(e)},t.prototype.getCacheCount=function(){return this.caches.size},t.prototype.getPoolCount=function(){return this.pools.size},t._instance=null,i([u(cc.Node)],t.prototype,"popupContainer",void 0),n=i([l],t)}(cc.Component);n.PopupManager=y,cc._RF.pop()},{"../utils/AsyncUtils":"AsyncUtils","./BasePopup":"BasePopup","./PopupConfig":"PopupConfig","./PopupData":"PopupData"}],ProcessCommand:[function(e,t,n){"use strict";cc._RF.push(t,"108d9aRpw5NWYLY+fRgY7pr","ProcessCommand");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.ProcessCommand=n.WaitCommand=n.BaseCommand=void 0;var i=e("./CommandManager"),s=function(){function e(e){this._state=i.CommandState.IDLE,this._onCompleteCallback=null,this._id=e||Math.random().toString(36).substr(2,9)}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.execute=function(){this._state===i.CommandState.IDLE&&(this._state=i.CommandState.RUNNING,this.onExecute())},e.prototype.update=function(e){this._state===i.CommandState.RUNNING&&this.onUpdate(e)},e.prototype.onUpdate=function(){},e.prototype.finish=function(){this._state===i.CommandState.RUNNING&&(this._state=i.CommandState.COMPLETED,this.onFinish(),this._onCompleteCallback&&this._onCompleteCallback())},e.prototype.onFinish=function(){},e.prototype.cancel=function(){this._state!==i.CommandState.RUNNING&&this._state!==i.CommandState.IDLE||(this._state=i.CommandState.CANCELLED,this.onCancel())},e.prototype.onCancel=function(){},e.prototype.onComplete=function(e){this._onCompleteCallback=e},e}();n.BaseCommand=s;var a=function(e){function t(t){var n=e.call(this)||this;return n._timer=0,n._duration=t,n}return r(t,e),t.prototype.onExecute=function(){this._timer=0,this._duration<=0&&this.finish()},t.prototype.onUpdate=function(e){this._timer+=e,this._timer>=this._duration&&this.finish()},t}(s);n.WaitCommand=a;var c=function(e){function t(t,n){var o=e.call(this,n)||this;return o._elapsedTime=0,o._delayTime=0,o._isDelayCompleted=!1,o._isActionCalled=!1,o._action=t.action,o._duration=t.duration||0,o._delay=t.delay||0,o._onEnd=t.onEnd,o._isDelayCompleted=o._delay<=0,o}return r(t,e),t.prototype.onExecute=function(){},t.prototype.onUpdate=function(e){if(!this._isDelayCompleted){if(this._delayTime+=e,!(this._delayTime>=this._delay))return;this._isDelayCompleted=!0;var t=this._delayTime-this._delay;this._elapsedTime+=t}this._isActionCalled||(this._action&&this._action(),this._isActionCalled=!0),this._elapsedTime+=e,this._elapsedTime>=this._duration&&this.finish()},t.prototype.onFinish=function(){this._onEnd&&this._onEnd()},t.prototype.onCancel=function(){this._onEnd&&this._onEnd()},t.prototype.changeDuration=function(e){e>0&&(this._duration=e)},t.prototype.clearDelay=function(){this._delayTime=0,this._isDelayCompleted=!0},t.prototype.skip=function(){this.cancel()},t}(s);n.ProcessCommand=c,cc._RF.pop()},{"./CommandManager":"CommandManager"}],RGPUtils:[function(e,t,n){"use strict";cc._RF.push(t,"ca9dbxN7KpJZKhsB+HglDlD","RGPUtils"),Object.defineProperty(n,"__esModule",{value:!0}),n.RGPUtils=void 0;var o=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.formatNumber=function(e,t){return void 0===t&&(t=0),isNaN(e)||!isFinite(e)?"0":e.toFixed(t).replace(/\B(?=(\d{3})+(?!\d))/g,",")},e.prototype.formatShortMoney=function(e,t){if(isNaN(e)||!isFinite(e))return"0";var n,o,r=void 0!==(null==t?void 0:t.decimals)?t.decimals:2,i=this.roundToDecimals(e,r);if(i>=1e9)n=this.roundToDecimals(i/1e9,r).toFixed(r),o="B";else if(i>=1e6)n=this.roundToDecimals(i/1e6,r).toFixed(r),o="M";else{if(!(i>=1e3)){var s=(null==t?void 0:t.prefix)||"",a=(null==t?void 0:t.suffix)||"";return""+s+Math.round(i).toString()+a}n=this.roundToDecimals(i/1e3,r).toFixed(r),o="K"}r>0&&(n=parseFloat(n).toString());var c=n.split("."),l=c[0],u=c[1],p=l.replace(/\B(?=(\d{3})+(?!\d))/g,",");return n=void 0!==u?p+"."+u:p,""+((null==t?void 0:t.prefix)||"")+n+o+((null==t?void 0:t.suffix)||"")},e.prototype.formatFullMoney=function(e,t){if(isNaN(e)||!isFinite(e))return"0";var n,o=void 0!==(null==t?void 0:t.decimals)?t.decimals:2,r=this.roundToDecimals(e,o).toFixed(o).split("."),i=r[0],s=r[1],a=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return n=o>0&&s?a+"."+s:a,""+((null==t?void 0:t.prefix)||"")+n+((null==t?void 0:t.suffix)||"")},e.prototype.formatTime=function(e,t,n){if(void 0===t&&(t="HH:MM:SS"),isNaN(e)||!isFinite(e))return"";var o=new Date(1e3*(e>1e12?e/1e3:e));if(isNaN(o.getTime()))return"";var r=(null==n?void 0:n.use12Hour)||!1;return this.formatTimeByCustomFormat(o,t,r)},e.prototype.formatTimeByCustomFormat=function(e,t,n){var o=this.padZero(e.getDate()),r=this.padZero(e.getMonth()+1),i=e.getFullYear(),s=this.padZero(i%100),a=e.getHours(),c=this.padZero(e.getMinutes()),l=this.padZero(e.getSeconds()),u="";n&&(u=a>=12?"PM":"AM",0==(a%=12)&&(a=12));var p=this.padZero(e.getHours()),h=t;return(h=(h=(h=(h=(h=(h=(h=(h=h.replace(/yyyy/g,i.toString())).replace(/yy/g,s)).replace(/dd/g,o)).replace(/mm/g,r)).replace(/HH/g,p)).replace(/MM/g,c)).replace(/SS/g,l)).replace(/AMPM/g,u)).replace(/ampm/g,u.toLowerCase())},e.prototype.getCurrentTime=function(){try{var e=new Date;return this.padZero(e.getHours())+":"+this.padZero(e.getMinutes())+":"+this.padZero(e.getSeconds())}catch(t){return console.error("[RGPUtils] Error in getCurrentTime:",t),"00:00:00"}},e.prototype.roundToDecimals=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},e.prototype.padZero=function(e){return e<10?"0"+e:e.toString()},e._instance=null,e}();n.RGPUtils=o,cc._RF.pop()},{}],ResultState:[function(e,t,n){"use strict";cc._RF.push(t,"f99c7FXy8hI5p65jvYT80fk","ResultState");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.ResultState=void 0;var s=e("../../game-libs/pattern/command/ProcessCommand"),a=e("../core/GameDataConfig"),c=e("./SlotState"),l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onEnterState=function(){this.getStateMachine().btnStop.active=!0,this.getStateMachine().btnStop.getComponent(cc.Button).interactable=!0},t.prototype.onExitState=function(){this.getStateMachine().btnStop.active=!1},t.prototype.registerCommandEvents=function(){this.node.on(a.EXECUTE_EVENT.SHOW_RESULT,this.onResult,this),this.node.on(a.EXECUTE_EVENT.COMPLETE_SPIN,this.onCompleteSpin,this),this.node.on(a.EXECUTE_EVENT.SKIP_REWARD,this.onSkipReward,this)},t.prototype.unregisterCommandEvents=function(){this.node.off(a.EXECUTE_EVENT.SHOW_RESULT,this.onResult,this),this.node.off(a.EXECUTE_EVENT.COMPLETE_SPIN,this.onCompleteSpin,this),this.node.off(a.EXECUTE_EVENT.SKIP_REWARD,this.onSkipReward,this)},t.prototype.onResult=function(e){var t=this;if(cc.warn("RESULT: ",e),this.isRunning){var n=[],o=e.matrixResult,r=e.isEndSession,i=e.matrixWin,a=e.winAmount,c=e.newBalance;n.push(new s.ProcessCommand({action:function(){t.getStateMachine().slotTable.showResult(o)},duration:.1})),this.pendingResultCommand=new s.ProcessCommand({action:function(){t.getStateMachine().slotTable.getLastReel().setCompleteSpinCallback(function(){t.onCompleteSpin()})},duration:1e3}),n.push(this.pendingResultCommand),n.push(new s.ProcessCommand({action:function(){t.getStateMachine().slotTable.showWinLight(i)},duration:1})),a&&(this.rewardCommand=new s.ProcessCommand({action:function(){t.getStateMachine().updateWinAmount(a,10),t.getStateMachine().updateBalance(c,10),t.getStateMachine().btnStop.active=!1,t.getStateMachine().btnSkipReward.active=!0,t.getStateMachine().btnSkipReward.getComponent(cc.Button).interactable=!0},onEnd:function(){t.getStateMachine().btnSkipReward.getComponent(cc.Button).interactable=!1,t.getStateMachine().updateWinAmount(a,0),t.getStateMachine().updateBalance(c,0)},duration:10})),n.push(this.rewardCommand),r&&(n.push(new s.ProcessCommand({action:function(){t.getStateMachine().clearSession()},duration:3})),this.runCommands("RESULT",n))}},t.prototype.onCompleteSpin=function(){this.pendingResultCommand&&(this.pendingResultCommand.skip(),this.pendingResultCommand=null)},t.prototype.onSkipReward=function(){this.rewardCommand&&(this.rewardCommand.skip(),this.rewardCommand=null)},i([u],t)}(c.SlotState));n.ResultState=p,cc._RF.pop()},{"../../game-libs/pattern/command/ProcessCommand":"ProcessCommand","../core/GameDataConfig":"GameDataConfig","./SlotState":"SlotState"}],SceneManager:[function(e,t,n){"use strict";cc._RF.push(t,"8c143KJovlEXokhPnh9SdXq","SceneManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.SceneManager=void 0;var a=cc._decorator.ccclass,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneHistory=[],t.currentScene="",t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e;n._instance=this,this.currentScene=(null===(e=cc.director.getScene())||void 0===e?void 0:e.name)||""},t.prototype.onDestroy=function(){n._instance===this&&(n._instance=null)},t.prototype.loadScene=function(e,t){void 0===t&&(t=!0),t&&this.currentScene&&this.sceneHistory.push(this.currentScene),this.currentScene=e,cc.director.loadScene(e)},t.prototype.loadPreviousScene=function(){if(0===this.sceneHistory.length)return console.warn("[SceneManager] No previous scene in history"),!1;var e=this.sceneHistory.pop();return!!e&&(this.loadScene(e,!1),!0)},t.prototype.getCurrentScene=function(){return this.currentScene},t.prototype.getHistory=function(){return s(this.sceneHistory)},t.prototype.clearHistory=function(){this.sceneHistory=[]},t.prototype.canGoBack=function(){return this.sceneHistory.length>0},t._instance=null,n=i([a],t)}(cc.Component);n.SceneManager=c,cc._RF.pop()},{}],ScreenConfig:[function(e,t,n){"use strict";var o,r;cc._RF.push(t,"53dacofvT9AFacYjwN7m9Yc","ScreenConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.SCREEN_PREFAB_NAMES=n.PATH_PREFAB_SCREEN=n.ScreenType=void 0,function(e){e[e.NONE=0]="NONE",e[e.LOGIN=1]="LOGIN",e[e.MAIN=2]="MAIN"}(r=n.ScreenType||(n.ScreenType={})),n.PATH_PREFAB_SCREEN="prefabs/screens/",n.SCREEN_PREFAB_NAMES=((o={})[r.LOGIN]="LoginScreen",o[r.MAIN]="MainScreen",o),cc._RF.pop()},{}],ScreenManager:[function(e,t,n){"use strict";cc._RF.push(t,"23b145ePDtG5KIpLp1Ik0ag","ScreenManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.ScreenManager=void 0;var l=cc._decorator,u=l.ccclass,p=l.property,h=e("./BaseScreen"),f=e("./ScreenConfig"),d=e("../utils/AsyncUtils"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.screenContainer=null,t.preloadScreens=[],t.currentScreen=f.ScreenType.NONE,t.screenHistory=[],t.screenNodes=new Map,t.screenComponents=new Map,t.screenPrefabs=new Map,t.loadingPromises=new Map,t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){return s(this,void 0,Promise,function(){return a(this,function(e){switch(e.label){case 0:return n._instance=this,this.initializeScreens(),[4,this.preloadConfiguredScreens()];case 1:return e.sent(),[2]}})})},t.prototype.preloadConfiguredScreens=function(){return s(this,void 0,Promise,function(){return a(this,function(e){switch(e.label){case 0:return this.preloadScreens&&this.preloadScreens.length>0?(console.log("[ScreenManager] Preloading "+this.preloadScreens.length+" configured screens..."),[4,this.preloadScreensArray(this.preloadScreens)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.preloadScreensArray=function(e){return s(this,void 0,Promise,function(){var t=this;return a(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(e){return t.preloadScreen(e)}))];case 1:return n.sent(),[2]}})})},t.prototype.onDestroy=function(){n._instance===this&&(n._instance=null)},t.prototype.initializeScreens=function(){var e=this;this.screenContainer?this.screenContainer.children.forEach(function(t){var n=t.getComponent(h.BaseScreen);if(n){var o=n.getScreenType();o!==f.ScreenType.NONE&&(e.screenNodes.set(o,t),e.screenComponents.set(o,n),t.active=!1)}}):console.warn("[ScreenManager] Screen container not assigned")},t.prototype.showScreen=function(e,t,n){return void 0===n&&(n=!0),s(this,void 0,Promise,function(){var o,r;return a(this,function(i){switch(i.label){case 0:return e===f.ScreenType.NONE?(console.warn("[ScreenManager] Cannot show NONE screen"),[2]):(this.currentScreen!==f.ScreenType.NONE&&n&&(this.hideScreen(this.currentScreen),this.screenHistory.push(this.currentScreen)),o=this.screenNodes.get(e),r=this.screenComponents.get(e),o?[3,2]:[4,this.loadScreen(e)]);case 1:if(!(o=i.sent()))return console.error("[ScreenManager] Failed to load screen: "+e),[2];r=this.screenComponents.get(e),i.label=2;case 2:return o&&(r&&r.setup(t),o.active=!0,this.currentScreen=e),[2]}})})},t.prototype.loadScreen=function(e){return s(this,void 0,Promise,function(){var t,n,o;return a(this,function(r){switch(r.label){case 0:return(t=this.loadingPromises.get(e))?[4,t]:[3,2];case 1:return[2,r.sent()];case 2:if(!(n=f.SCREEN_PREFAB_NAMES[e]))return console.warn("[ScreenManager] Screen prefab name not configured for type: "+e),[2,null];o=this.loadScreenFromPrefab(e,n),this.loadingPromises.set(e,o),r.label=3;case 3:return r.trys.push([3,,5,6]),[4,o];case 4:return[2,r.sent()];case 5:return this.loadingPromises.delete(e),[7];case 6:return[2]}})})},t.prototype.loadScreenFromPrefab=function(e,t){return s(this,void 0,Promise,function(){var n,o,r,i,s;return a(this,function(a){switch(a.label){case 0:return n=f.PATH_PREFAB_SCREEN+t,this.screenPrefabs.has(e)?(o=this.screenPrefabs.get(e),[2,this.instantiateScreen(e,o)]):(r=!1,i=null,s=null,cc.resources.load(n,cc.Prefab,function(e,t){if(r=!0,e)return s=e,void console.error("[ScreenManager] Failed to load prefab: "+n,e.message);i=t}),[4,d.waitUntil(function(){return r})]);case 1:return a.sent(),s||!i?[2,null]:(this.screenPrefabs.set(e,i),[2,this.instantiateScreen(e,i)])}})})},t.prototype.instantiateScreen=function(e,t){var n=this;if(!this.screenContainer)return console.error("[ScreenManager] Screen container not assigned"),null;var o=cc.instantiate(t);this.screenContainer.addChild(o);var r=o.getComponent(h.BaseScreen);return r?(r.getScreenType()!==e&&console.warn("[ScreenManager] Screen type mismatch. Expected: "+e+", Got: "+r.getScreenType()),this.screenNodes.set(e,o),this.screenComponents.set(e,r),o.active=!1,this.scheduleOnce(function(){n.applyCanvasScale(o)},0),console.log("[ScreenManager] Loaded and registered screen: "+e),o):(console.error("[ScreenManager] Prefab missing BaseScreen component: "+e),o.destroy(),null)},t.prototype.applyCanvasScale=function(e){var t=cc.view.getDesignResolutionSize().width,n=cc.view.getDesignResolutionSize().height,o=cc.view.getVisibleSize(),r=o.height/n,i=o.width/t,s=Math.min(i,r);e.setScale(s,s)},t.prototype.hideScreen=function(e){if(e!==f.ScreenType.NONE){var t=this.screenNodes.get(e);t&&(t.active=!1)}},t.prototype.showPreviousScreen=function(){return s(this,void 0,Promise,function(){var e;return a(this,function(t){switch(t.label){case 0:return 0===this.screenHistory.length?(console.warn("[ScreenManager] No previous screen in history"),[2,!1]):(e=this.screenHistory.pop())?[4,this.showScreen(e,void 0,!1)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},t.prototype.getCurrentScreen=function(){return this.currentScreen},t.prototype.registerScreen=function(e,t){this.screenNodes.set(e,t);var n=t.getComponent(h.BaseScreen);n&&this.screenComponents.set(e,n),t.active=!1},t.prototype.getScreenComponent=function(e){return this.screenComponents.get(e)||null},t.prototype.getHistory=function(){return c(this.screenHistory)},t.prototype.clearHistory=function(){this.screenHistory=[]},t.prototype.canGoBack=function(){return this.screenHistory.length>0},t.prototype.preloadScreen=function(e){return s(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return this.screenNodes.has(e)?[2,!0]:this.screenPrefabs.has(e)?[2,!0]:[4,this.loadScreen(e)];case 1:return[2,null!==t.sent()]}})})},t.prototype.unloadScreen=function(e){var t=this.screenNodes.get(e);t&&(t.destroy(),this.screenNodes.delete(e),this.screenComponents.delete(e),console.log("[ScreenManager] Unloaded screen: "+e))},t.prototype.clearScreenCache=function(e){this.screenPrefabs.delete(e),this.unloadScreen(e)},t.prototype.clearAllCaches=function(){var e=this;this.screenPrefabs.clear(),this.screenNodes.forEach(function(t,n){n!==e.currentScreen&&t.destroy()}),this.screenNodes.clear(),this.screenComponents.clear()},t.prototype.isScreenLoaded=function(e){return this.screenNodes.has(e)},t.prototype.isScreenCached=function(e){return this.screenPrefabs.has(e)},t._instance=null,i([p(cc.Node)],t.prototype,"screenContainer",void 0),i([p({type:[cc.Enum(f.ScreenType)],tooltip:"Screens to preload on initialization"})],t.prototype,"preloadScreens",void 0),n=i([u],t)}(cc.Component);n.ScreenManager=y,cc._RF.pop()},{"../utils/AsyncUtils":"AsyncUtils","./BaseScreen":"BaseScreen","./ScreenConfig":"ScreenConfig"}],ScriptLoader:[function(e,t,n){"use strict";cc._RF.push(t,"b6b45Sp8I5IbqBZ/v6QCOeN","ScriptLoader");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ScriptLoader=void 0;var i=function(){function e(){}return e.loadScript=function(e,t){var n,i;return void 0===t&&(t={}),o(this,void 0,Promise,function(){var o;return r(this,function(r){switch(r.label){case 0:if(!e||"string"!=typeof e)throw o=new Error("Invalid CDN URL"),null===(n=t.onError)||void 0===n||n.call(t,o),o;if(this._loadingScripts.get(e))return cc.log("[ScriptLoader] Script already loading: "+e),[2];if(this.isScriptLoaded(e))return cc.log("[ScriptLoader] Script already loaded: "+e),null===(i=t.onLoad)||void 0===i||i.call(t),[2];this._loadingScripts.set(e,!0),r.label=1;case 1:return r.trys.push([1,,6,7]),"function"!=typeof cc.sys.loadScriptDynamic?[3,3]:[4,this.loadScriptDynamic(e,t)];case 2:return r.sent(),[3,5];case 3:return[4,this.loadScriptManual(e,t)];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return this._loadingScripts.delete(e),[7];case 7:return[2]}})})},e.loadScriptDynamic=function(e,t){return new Promise(function(n,o){cc.log("[ScriptLoader] Loading script from CDN using loadScriptDynamic: "+e),(0,cc.sys.loadScriptDynamic)(e,function(r){var i,s;if(r)return cc.warn("[ScriptLoader] Failed to load script: "+e,r),null===(i=t.onError)||void 0===i||i.call(t,r),void o(r);cc.log("[ScriptLoader] Script loaded successfully: "+e),null===(s=t.onLoad)||void 0===s||s.call(t),n()})})},e.loadScriptManual=function(e,t){return new Promise(function(n,o){var r;if("undefined"==typeof document){var i=new Error("Document is not available");return null===(r=t.onError)||void 0===r||r.call(t,i),void o(i)}cc.log("[ScriptLoader] Loading script manually: "+e);var s=document.createElement("script");s.type="text/javascript",s.async=!1!==t.async,s.src=e,s.onload=function(){var o;cc.log("[ScriptLoader] Script loaded successfully: "+e),null===(o=t.onLoad)||void 0===o||o.call(t),n()},s.onerror=function(){var n,r=new Error("Failed to load script: "+e);cc.warn("[ScriptLoader] Failed to load script: "+e),null===(n=t.onError)||void 0===n||n.call(t,r),o(r)},document.head.appendChild(s)})},e.isScriptLoaded=function(e){if("undefined"==typeof document)return!1;for(var t=document.querySelectorAll("script[src]"),n=0;n<t.length;n++){var o=t[n];if(o.src===e||o.src.includes(e))return!0}return!1},e.isScriptLoading=function(e){return!0===this._loadingScripts.get(e)},e._loadingScripts=new Map,e}();n.ScriptLoader=i,cc._RF.pop()},{}],SelectServerPopup:[function(e,t,n){"use strict";cc._RF.push(t,"13265t8wtlDCLKKV40riaXV","SelectServerPopup");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectServerPopup=void 0;var c=cc._decorator,l=c.ccclass,u=c.property,p=e("../popup/BasePopup"),h=e("../popup/PopupConfig"),f=e("./EnvironmentConfig"),d=e("../network/NetworkConfig"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropdownButton=null,t.dropdownLabel=null,t.dropdownOptionsContainer=null,t.dropdownOptionPrefab=null,t.currentEnvLabel=null,t.versionLabel=null,t.apiUrlLabel=null,t.wsUrlLabel=null,t.btnBack=null,t.btnApply=null,t.environments=[],t.selectedEnvironment=null,t.isDropdownOpen=!1,t}return r(t,e),t.prototype.setupUI=function(){e.prototype.setupUI.call(this),this.btnBack&&this.btnBack.node&&this.btnBack.node.on("click",this.onBackClick,this),this.btnApply&&this.btnApply.node&&this.btnApply.node.on("click",this.onApplyClick,this),this.dropdownButton&&this.dropdownButton.node&&this.dropdownButton.node.on("click",this.onDropdownToggle,this),this.dropdownOptionsContainer&&(this.dropdownOptionsContainer.active=!1),this.dropdownOptionPrefab&&(this.dropdownOptionPrefab.active=!1)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.type=h.PopupType.SELECT_SERVER},t.prototype.onShow=function(){return s(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return e.prototype.onShow.call(this),[4,this.loadEnvironments()];case 1:return t.sent(),this.updateUI(),[2]}})})},t.prototype.onHide=function(){e.prototype.onHide.call(this),this.closeDropdown()},t.prototype.cleanup=function(){e.prototype.cleanup.call(this),this.btnBack&&this.btnBack.node&&this.btnBack.node.off("click",this.onBackClick,this),this.btnApply&&this.btnApply.node&&this.btnApply.node.off("click",this.onApplyClick,this),this.dropdownButton&&this.dropdownButton.node&&this.dropdownButton.node.off("click",this.onDropdownToggle,this),this.clearDropdownOptions()},t.prototype.loadEnvironments=function(){return s(this,void 0,Promise,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return[4,(e=f.EnvironmentConfig.instance).loadConfig()];case 1:return n.sent()?(this.environments=e.getEnvironments(),(t=e.getCurrentEnvironment())?this.selectedEnvironment=t:this.environments.length>0&&(this.selectedEnvironment=this.environments[0]),this.updateDropdownLabel(),this.createDropdownOptions(),[2]):[2]}})})},t.prototype.createDropdownOptions=function(){var e=this;if(this.dropdownOptionsContainer&&this.dropdownOptionPrefab){this.clearDropdownOptions(),this.environments.forEach(function(t,n){var o=cc.instantiate(e.dropdownOptionPrefab);e.dropdownOptionsContainer.addChild(o),o.active=!0;var r=o.getComponentInChildren(cc.Label);r&&(r.string=t.displayName);var i=o.getComponent(cc.Button)||o.getComponentInChildren(cc.Button);i&&i.node.on("click",function(){e.onEnvironmentSelected(t),e.closeDropdown()},e);var s=o.getComponent(cc.Widget);s?(s.isAlignTop=!0,s.isAlignLeft=!0,s.top=42*n,s.left=0):o.setPosition(0,42*-n,0)});var t=42*this.environments.length-2;if(this.dropdownOptionsContainer){var n=this.dropdownOptionsContainer.width;this.dropdownOptionsContainer.setContentSize(n,t)}}},t.prototype.clearDropdownOptions=function(){var e=this;this.dropdownOptionsContainer&&this.dropdownOptionsContainer.children.slice().forEach(function(t){t!==e.dropdownOptionPrefab&&t.destroy()})},t.prototype.onDropdownToggle=function(){this.isDropdownOpen?this.closeDropdown():this.openDropdown()},t.prototype.openDropdown=function(){this.dropdownOptionsContainer&&(this.isDropdownOpen=!0,this.dropdownOptionsContainer.active=!0)},t.prototype.closeDropdown=function(){this.dropdownOptionsContainer&&(this.isDropdownOpen=!1,this.dropdownOptionsContainer.active=!1)},t.prototype.onEnvironmentSelected=function(e){this.selectedEnvironment=e,this.updateDropdownLabel(),this.updateEnvironmentInfo(),this.updateButtons()},t.prototype.updateDropdownLabel=function(){this.dropdownLabel&&this.selectedEnvironment&&(this.dropdownLabel.string=this.selectedEnvironment.displayName)},t.prototype.updateUI=function(){this.updateEnvironmentInfo(),this.updateButtons()},t.prototype.updateEnvironmentInfo=function(){this.selectedEnvironment&&(this.currentEnvLabel&&(this.currentEnvLabel.string="Current: "+this.selectedEnvironment.displayName),this.versionLabel&&(this.versionLabel.string="Version: "+this.selectedEnvironment.version),this.apiUrlLabel&&(this.apiUrlLabel.string="API: "+this.selectedEnvironment.apiBaseUrl),this.wsUrlLabel&&(this.wsUrlLabel.string="WebSocket: "+this.selectedEnvironment.wsBaseUrl))},t.prototype.updateButtons=function(){var e;if(this.btnApply){var t=f.EnvironmentConfig.instance.getCurrentEnvironment(),n=!t||t.name!==(null===(e=this.selectedEnvironment)||void 0===e?void 0:e.name);this.btnApply.interactable=n&&!!this.selectedEnvironment}},t.prototype.onBackClick=function(){this.close()},t.prototype.onApplyClick=function(){this.selectedEnvironment&&(f.EnvironmentConfig.instance.setCurrentEnvironment(this.selectedEnvironment),d.NetworkConfig.instance.setApiBaseUrl(this.selectedEnvironment.apiBaseUrl),d.NetworkConfig.instance.setWsBaseUrl(this.selectedEnvironment.wsBaseUrl),cc.sys&&cc.sys.localStorage&&cc.sys.localStorage.setItem("selectedEnvironment",JSON.stringify(this.selectedEnvironment)),console.log("[DebugScreen] Environment applied:",this.selectedEnvironment.name),console.log("[DebugScreen] API URL:",d.NetworkConfig.instance.getApiBaseUrl()),console.log("[DebugScreen] WS URL:",d.NetworkConfig.instance.getWsBaseUrl()),this.updateButtons(),this.btnApply&&(this.btnApply.interactable=!1))},t.prototype.getPopupType=function(){return h.PopupType.SELECT_SERVER},i([u(cc.Button)],t.prototype,"dropdownButton",void 0),i([u(cc.Label)],t.prototype,"dropdownLabel",void 0),i([u(cc.Node)],t.prototype,"dropdownOptionsContainer",void 0),i([u(cc.Node)],t.prototype,"dropdownOptionPrefab",void 0),i([u(cc.Label)],t.prototype,"currentEnvLabel",void 0),i([u(cc.Label)],t.prototype,"versionLabel",void 0),i([u(cc.Label)],t.prototype,"apiUrlLabel",void 0),i([u(cc.Label)],t.prototype,"wsUrlLabel",void 0),i([u(cc.Button)],t.prototype,"btnBack",void 0),i([u(cc.Button)],t.prototype,"btnApply",void 0),i([l],t)}(p.BasePopup);n.SelectServerPopup=y,cc._RF.pop()},{"../network/NetworkConfig":"NetworkConfig","../popup/BasePopup":"BasePopup","../popup/PopupConfig":"PopupConfig","./EnvironmentConfig":"EnvironmentConfig"}],SlotComponent:[function(e,t,n){"use strict";cc._RF.push(t,"cd2e1dJawhCqYbzmhysJAHG","SlotComponent");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotComponent=void 0;var s=e("./Declaration"),a=e("./GameAssetsManager"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.fireEvent=function(e,t){s.GlobalEventManager.Instance.fireEvent(e,t)},t.prototype.registerEvents=function(e,t,n){s.GlobalEventManager.Instance.registerEvents(e,t,n)},t.prototype.registerOnceEvents=function(e,t,n){s.GlobalEventManager.Instance.registerOnce(e,t,n)},t.prototype.removeEvents=function(e,t,n){s.GlobalEventManager.Instance.unregisterEvents(e,t,n)},t.prototype.setDataStore=function(e,t){s.GlobalDataManager.setDataStore(e,t)},t.prototype.getDataStore=function(e){return s.GlobalDataManager.getDataStore(e)},t.prototype.setLocalStorage=function(e,t){s.GlobalDataManager.setLocalStoreByKey(e,t)},t.prototype.getLocalStorage=function(e){return s.GlobalDataManager.getLocalStoreByKey(e)},Object.defineProperty(t.prototype,"AssetsManager",{get:function(){return a.GameAssetsManager.Instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GlobalDataManager",{get:function(){return s.GlobalDataManager.Instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GlobalEventManager",{get:function(){return s.GlobalEventManager.Instance},enumerable:!1,configurable:!0}),i([l],t)}(cc.Component));n.SlotComponent=u,cc._RF.pop()},{"./Declaration":"Declaration","./GameAssetsManager":"GameAssetsManager"}],SlotController:[function(e,t,n){"use strict";cc._RF.push(t,"7439ac+nOREXp05Sm2mkUS+","SlotController");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotController=void 0;var s=e("./core/GameDataConfig"),a=e("./core/GameDataWrapper"),c=e("./Declaration"),l=e("./states/StateDefine"),u=e("./reel/SlotTable"),p=e("../mock/MockApi"),h=cc._decorator,f=h.ccclass,d=h.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnSpin=null,t.btnStop=null,t.btnSkipReward=null,t.slotTable=null,t.winAmountLabel=null,t.balanceLabel=null,t}return r(t,e),t.prototype.onLoad=function(){this.initStateMachine(),this.initGameData(),this.initGame()},t.prototype.initStateMachine=function(){this.registerState(l.GAME_STATE.IDLE,"IdleState",this.node.getComponent("IdleState")),this.registerState(l.GAME_STATE.SPIN,"SpinState",this.node.getComponent("SpinState")),this.registerState(l.GAME_STATE.RESULT,"ResultState",this.node.getComponent("ResultState")),this.changeState(l.GAME_STATE.IDLE)},t.prototype.initGameData=function(){this.gameDataWrapper=new a.GameDataWrapper},t.prototype.initGame=function(){this.btnSpin.on("click",this.onClickSpin,this),this.btnStop.on("click",this.onClickStop,this),this.btnSkipReward.on("click",this.onClickSkipReward,this)},t.prototype.canChangeState=function(e){return!this.currentState||l.STATE_TRANSITION[this.currentState.stateId].indexOf(e)>=0},t.prototype.onClickSpin=function(){var e=this;this.isCurrentState(l.GAME_STATE.IDLE)&&(this.resetUIBeforeSpin(),this.changeState(l.GAME_STATE.SPIN),this.executeScripts(this.gameDataWrapper.makeScriptExecuteSpin()),this.scheduleOnce(function(){e.changeState(l.GAME_STATE.RESULT);var t=p.MockApi.instance.getMocApikData();e.executeScripts(e.gameDataWrapper.makeScriptExecuteResult(t))},.2))},t.prototype.onClickStop=function(){this.btnStop.getComponent(cc.Button).interactable=!1,this.btnStop.opacity=155,this.slotTable.stopSpin()},t.prototype.onClickSkipReward=function(){this.executeScripts([{code:s.EXECUTE_EVENT.SKIP_REWARD,data:null}])},t.prototype.executeScripts=function(e){var t=this;e.forEach(function(e){var n=e.code,o=e.data;t.node.emit(n,o)})},t.prototype.updateWinAmount=function(e,t){void 0===t&&(t=0),t>0?c.TweenService.Instance.tweenMoney(this.winAmountLabel.node,{from:0,to:e,isFormatFullMoney:!0,duration:t}):(c.TweenService.Instance.clearNodeTweens(this.winAmountLabel.node),this.winAmountLabel.string=c.RGPUtils.Instance.formatFullMoney(e))},t.prototype.updateBalance=function(e,t){void 0===t&&(t=0),t>0?c.TweenService.Instance.tweenMoney(this.balanceLabel.node,{from:0,to:e,isFormatFullMoney:!0,duration:t}):(c.TweenService.Instance.clearNodeTweens(this.balanceLabel.node),this.balanceLabel.string=c.RGPUtils.Instance.formatFullMoney(e))},t.prototype.resetUIBeforeSpin=function(){this.updateWinAmount(0,0),this.updateBalance(0,0)},t.prototype.clearSession=function(){this.btnSpin.active=!0,this.btnSkipReward.active=!1,this.btnStop.active=!1,this.slotTable.resetEndSession(),this.changeState(l.GAME_STATE.IDLE)},i([d({type:cc.Node})],t.prototype,"btnSpin",void 0),i([d({type:cc.Node})],t.prototype,"btnStop",void 0),i([d({type:cc.Node})],t.prototype,"btnSkipReward",void 0),i([d({type:u.SlotTable})],t.prototype,"slotTable",void 0),i([d({type:cc.Label})],t.prototype,"winAmountLabel",void 0),i([d({type:cc.Label})],t.prototype,"balanceLabel",void 0),i([f],t)}(c.StateMachine);n.SlotController=y,cc._RF.pop()},{"../mock/MockApi":"MockApi","./Declaration":"Declaration","./core/GameDataConfig":"GameDataConfig","./core/GameDataWrapper":"GameDataWrapper","./reel/SlotTable":"SlotTable","./states/StateDefine":"StateDefine"}],SlotReelControl:[function(e,t,n){"use strict";cc._RF.push(t,"0d988z1ystGI7qWOvd2pg/y","SlotReelControl");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotReelControl=void 0;var s=e("../SlotComponent"),a=e("./SlotReel"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listReel=[],t}return r(t,e),t.prototype.onLoad=function(){this.initReel()},t.prototype.initReel=function(){var e=this;this.node.children.forEach(function(t){var n=t.getComponent(a.SlotReel);e.listReel.push(n)})},t.prototype.startSpinReel=function(){this.setEnableMask(!0),this.listReel.forEach(function(e){e.startSpin()})},t.prototype.showReelResult=function(e){for(var t=0;t<e.length;t++)this.listReel[t].showResult(e[t])},t.prototype.showWinLight=function(e){this.setEnableMask(!1);for(var t=0;t<e.length;t++)this.listReel[t].showWinLight(e[t])},t.prototype.stopSpinReel=function(){this.listReel.forEach(function(e){e.stopSpin()})},t.prototype.getLastReel=function(){return this.listReel[this.listReel.length-1]},t.prototype.setEnableMask=function(e){this.node.getComponent(cc.Mask).enabled=e},t.prototype.resetEndSession=function(){this.listReel.forEach(function(e){e.resetEndSession()})},i([l],t)}(s.SlotComponent));n.SlotReelControl=u,cc._RF.pop()},{"../SlotComponent":"SlotComponent","./SlotReel":"SlotReel"}],SlotReel:[function(e,t,n){"use strict";cc._RF.push(t,"73be3R7qllBBYw0zZNEL/AD","SlotReel");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotReel=void 0;var s=e("../Declaration"),a=e("../constants/GameConstants"),c=e("../SlotComponent"),l=e("./SlotSymbol"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.symShowing=3,t.spinSymbolsCount=5,t.prefabSymbol=null,t.defaultReel=[a.ESlotId.Carrot,a.ESlotId.Corn,a.ESlotId.Tomato],t.cbCompleteSpin=null,t.orgReelPos=cc.Vec2.ZERO,t.showingSymbols=[],t.spinSymbols=[],t.symbolHeight=0,t.mapOrgPosSymbols=new Map,t.canSpin=!1,t.isSpinning=!1,t.isLastSpin=!1,t.speedUp=!1,t.resultData=null,t.deltaY=0,t.lastDeltaY=0,t.spinCount=0,t.requireSpinCountCanStop=0,t.minTimeSpinning=20,t.currentSpeed=0,t}return r(t,e),t.prototype.onLoad=function(){this.setupReel()},t.prototype.setupReel=function(){var e=this;if(this.prefabSymbol){this.node.getComponent(cc.Layout)&&(this.node.getComponent(cc.Layout).enabled=!1),this.orgReelPos=this.node.getPosition(),this.symbolHeight=this.prefabSymbol.data.height,this.node.removeAllChildren();for(var t=-this.symbolHeight,n=0;n<this.symShowing;n++){(r=this.generateSymbol()).setPosition(r.x,t);var o=r.getComponent(l.SlotSymbol);r.name=o.name="RealSymbol"+n,o.showCoreSymbolByCode(a.SlotSymbolMap[this.defaultReel[n]]),this.showingSymbols.push(o),this.mapOrgPosSymbols.set(r,r.getPosition()),t+=this.symbolHeight}for(this.showingSymbols.sort(function(e,t){return e.node.y-t.node.y}),this.showingSymbols.forEach(function(t,n){t.node.setSiblingIndex(e.showingSymbols.length-1-n)}),n=0;n<this.spinSymbolsCount;n++){var r;(r=this.generateSymbol()).setPosition(r.x,t),(o=r.getComponent(l.SlotSymbol)).showBlurSymbolByCode(),r.name=o.name="SpinSymbol"+n,this.spinSymbols.push(o),this.mapOrgPosSymbols.set(r,r.getPosition()),t+=this.symbolHeight}}else cc.error("[BaseReel] Prefab symbol is null")},t.prototype.generateSymbol=function(){var e=cc.instantiate(this.prefabSymbol);return e.parent=this.node,e.active=!0,e},t.prototype.hideSpinSymbols=function(){this.spinSymbols.forEach(function(e){e.node.active=!1})},t.prototype.showSpinSymbols=function(){this.spinSymbols.forEach(function(e){e.node.active=!0})},t.prototype.hideRealSymbols=function(){this.showingSymbols.forEach(function(e){e.node.active=!1})},t.prototype.showRealSymbols=function(){this.showingSymbols.forEach(function(e){e.node.active=!0})},t.prototype.startSpin=function(e){void 0===e&&(e=0),this.resetBeforeSpin(),this.runAnimStartSpin(e),this.currentSpeed=a.SPEED_CONFIG.SPEED_NORMAL},t.prototype.stopSpin=function(){this.speedUp=!0},t.prototype.setCompleteSpinCallback=function(e){this.cbCompleteSpin=e},t.prototype.runAnimStartSpin=function(e){var t=this;void 0===e&&(e=0),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).delay(e).to(.15,{y:this.orgReelPos.y+25},{easing:"quadOut"}).to(.15,{y:this.orgReelPos.y},{easing:"quadIn"}).call(function(){t.node.setPosition(t.orgReelPos),t.deltaY=t.symbolHeight+t.symbolHeight*t.showingSymbols.length,t.requestSpinning()}).start()},t.prototype.runAnimFinishSpin=function(e){var t=this;void 0===e&&(e=0),this.resetPos(),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).delay(e).to(.15,{y:this.orgReelPos.y-50},{easing:"quadIn"}).to(.15,{y:this.orgReelPos.y},{easing:"quadOut"}).call(function(){t.node.setPosition(t.orgReelPos),t.cbCompleteSpin&&(t.cbCompleteSpin(),t.cbCompleteSpin=null)}).start()},t.prototype.requestSpinning=function(){this.canSpin=!0},t.prototype.canStop=function(){if(!Array.isArray(this.resultData)||0===this.resultData.length)return!1;if(this.speedUp)return!0;var e=this.spinCount>this.requireSpinCountCanStop;return this.spinCount>this.minTimeSpinning&&e},t.prototype.setDataResult=function(){var e=this;this.fireEvent(s.GLOBAL_EVENTS.SPIN_LAST,this.node.getSiblingIndex()),this.resultData.forEach(function(t,n){e.showingSymbols[n].showCoreSymbolByCode(t)})},t.prototype.updateSpeed=function(){this.currentSpeed=this.getNewSpeed()},t.prototype.getNewSpeed=function(){return this.speedUp?a.SPEED_CONFIG.SPEED_TURBO:this.isLastSpin?a.SPEED_CONFIG.SPEED_SLOW:a.SPEED_CONFIG.SPEED_NORMAL},t.prototype.spinLoop=function(){var e=this.spinSymbols.shift();e.showBlurSymbolByCode();var t=Math.abs(this.node.position.y)+this.symbolHeight*Math.floor(this.spinSymbols.length/2);e.node.setPosition(e.node.x,t,e.node.z),this.spinSymbols.push(e),this.deltaY=this.symbolHeight},t.prototype.lastSpin=function(){var e=this,t=Math.abs(this.node.position.y),n=t+this.symbolHeight*(this.showingSymbols.length-1);this.showingSymbols.forEach(function(t){t.node.setPosition(t.node.x,n),n+=e.symbolHeight});var o=this.showingSymbols[Math.floor(this.showingSymbols.length/2)];this.deltaY=Math.abs(o.node.position.y-t+this.symbolHeight)},t.prototype.showResult=function(e){this.resultData=e},t.prototype.showWinLight=function(e){this.hideSpinSymbols(),this.showingSymbols.forEach(function(t,n){e[n]?t.showAnimSymbolByCode(e[n],l.AnimType.REWARD,!0):t.dimSymbol()})},t.prototype.completeSpin=function(){this.runAnimFinishSpin()},t.prototype.resetBeforeSpin=function(){this.resetPos(),this.showSpinSymbols()},t.prototype.resetPos=function(){this.node.setPosition(this.orgReelPos.x,this.orgReelPos.y+this.lastDeltaY),this.mapOrgPosSymbols.forEach(function(e,t){t.setPosition(e),t.getComponent(l.SlotSymbol).resetSymbol()})},t.prototype.resetEndSession=function(){this.canSpin=!1,this.isSpinning=!1,this.isLastSpin=!1,this.speedUp=!1,this.resultData=null,this.deltaY=0,this.spinCount=0,this.requireSpinCountCanStop=0,this.currentSpeed=0,this.cbCompleteSpin=null},t.prototype.update=function(e){if(this.canSpin){this.isSpinning=!this.isLastSpin;var t=this.currentSpeed*e,n=this.node.position.clone();for(this.node.setPosition(n.x,n.y-t),this.deltaY-=t;this.deltaY<=0;){if(this.isLastSpin){this.canSpin=!1,this.completeSpin();break}if(this.canStop()){this.isLastSpin=!0,this.setDataResult(),this.lastSpin(),this.updateSpeed();break}this.lastDeltaY=this.deltaY,this.spinCount++,this.spinLoop(),this.updateSpeed()}}},i([h({displayName:"Symbols showing"})],t.prototype,"symShowing",void 0),i([h({displayName:"Symbols spinning"})],t.prototype,"spinSymbolsCount",void 0),i([h({displayName:"Prefab symbol",type:cc.Prefab})],t.prototype,"prefabSymbol",void 0),i([h({displayName:"Default Symbols",type:[cc.Enum(a.ESlotId)]})],t.prototype,"defaultReel",void 0),i([p],t)}(c.SlotComponent);n.SlotReel=f,cc._RF.pop()},{"../Declaration":"Declaration","../SlotComponent":"SlotComponent","../constants/GameConstants":"GameConstants","./SlotSymbol":"SlotSymbol"}],SlotState:[function(e,t,n){"use strict";cc._RF.push(t,"431f4a8a/pErZG6SSNMvP5M","SlotState");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotState=void 0;var s=e("../Declaration"),a=e("../SlotController"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getStateMachine=function(){return this.getComponent(a.SlotController)},i([l],t)}(s.BaseState));n.SlotState=u,cc._RF.pop()},{"../Declaration":"Declaration","../SlotController":"SlotController"}],SlotSymbol:[function(e,t,n){"use strict";cc._RF.push(t,"74e84QGynpH17sZltOWtJIO","SlotSymbol");var o,r,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotSymbol=n.AnimType=void 0;var a,c=e("../constants/GameConstants"),l=e("../SlotComponent"),u=cc._decorator,p=u.ccclass,h=u.property;(function(e){e[e.IDLE=0]="IDLE",e[e.STOP=1]="STOP",e[e.REWARD=2]="REWARD"})(a=n.AnimType||(n.AnimType={}));var f=((r={})[a.IDLE]="anim_idle",r[a.STOP]="anim_stop",r[a.REWARD]="animation",r),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.coreNode=null,t.blurNode=null,t.animNode=null,t._dimColor=cc.color(80,80,80,255),t._defaultColor=cc.color(255,255,255,255),t._code=c.ESlotSymbol.Cabbage,t}return i(t,e),Object.defineProperty(t.prototype,"code",{get:function(){return this._code},enumerable:!1,configurable:!0}),t.prototype.showCoreSymbolByCode=function(e){this.deactive(),this.coreNode.active=!0,this.setCoreSymbol(e)},t.prototype.showBlurSymbolByCode=function(e){e=e||this.getRandomCode(),this.deactive(),this.blurNode.active=!0,this.setBlurSymbol(e)},t.prototype.showAnimSymbolByCode=function(e,t,n){this.deactive(),this.animNode.active=!0,this.setAnimSymbol(e,t,n)},t.prototype.dimSymbol=function(){this.coreNode.color=this._dimColor},t.prototype.resetSymbol=function(){this.coreNode.color=this._defaultColor},t.prototype.setCoreSymbol=function(e){this._code=e;var t=this.AssetsManager.getSymbolByCode(this._code);t?this.coreNode.getComponent(cc.Sprite).spriteFrame=t:cc.warn("!do not setCoreSymbol",this._code)},t.prototype.setBlurSymbol=function(e){this._code=e;var t=this.AssetsManager.getFakeSymbolByCode(this._code);t?this.blurNode.getComponent(cc.Sprite).spriteFrame=t:cc.warn("!do not setBlurSymbol",this._code)},t.prototype.setAnimSymbol=function(e,t,n){this._code=e;var o=this.AssetsManager.getSpineByCode(this._code);if(o){this.animNode.getComponent(sp.Skeleton).skeletonData=o,this.animNode.getComponent(sp.Skeleton).setToSetupPose();var r=e===c.ESlotSymbol.Scatter?"en":f[t];this.animNode.getComponent(sp.Skeleton).setAnimation(0,r,n)}else cc.warn("!do not setAnimSymbol",this._code)},t.prototype.getRandomCode=function(){var e=Math.floor(8*Math.random());return c.SlotSymbolMap[e]},t.prototype.deactive=function(){this.coreNode.active=!1,this.blurNode.active=!1,this.animNode.active=!1},s([h(cc.Node)],t.prototype,"coreNode",void 0),s([h(cc.Node)],t.prototype,"blurNode",void 0),s([h(cc.Node)],t.prototype,"animNode",void 0),s([p],t)}(l.SlotComponent);n.SlotSymbol=d,cc._RF.pop()},{"../SlotComponent":"SlotComponent","../constants/GameConstants":"GameConstants"}],SlotTable:[function(e,t,n){"use strict";cc._RF.push(t,"c5cdam2uUZBk7YDuWnKTpca","SlotTable");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SlotTable=void 0;var s=e("../SlotComponent"),a=e("./SlotReelControl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slotReelControl=null,t}return r(t,e),t.prototype.startSpin=function(){this.slotReelControl.startSpinReel()},t.prototype.showResult=function(e){this.slotReelControl.showReelResult(e)},t.prototype.showWinLight=function(e){this.slotReelControl.showWinLight(e)},t.prototype.resetEndSession=function(){this.slotReelControl.resetEndSession()},t.prototype.getLastReel=function(){return this.slotReelControl.getLastReel()},t.prototype.stopSpin=function(){this.slotReelControl.stopSpinReel()},i([u(a.SlotReelControl)],t.prototype,"slotReelControl",void 0),i([l],t)}(s.SlotComponent);n.SlotTable=p,cc._RF.pop()},{"../SlotComponent":"SlotComponent","./SlotReelControl":"SlotReelControl"}],SoundConfig:[function(e,t,n){"use strict";cc._RF.push(t,"bffe3po3DZPq7bb59ZiuAV+","SoundConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.SoundType=n.PATH_CLIP_SOUND=void 0,n.PATH_CLIP_SOUND="sounds/",function(e){e.BG="BGM",e.CLICK="Clicker"}(n.SoundType||(n.SoundType={})),cc._RF.pop()},{}],SoundManager:[function(e,t,n){"use strict";cc._RF.push(t,"51442AvochPab8oungmWt64","SoundManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.SoundManager=void 0;var c=cc._decorator,l=c.ccclass,u=(c.property,e("./SoundConfig")),p=e("../utils/AsyncUtils"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.caches=new Map,t}var n;return r(t,e),n=t,Object.defineProperty(t,"Instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.setVolumeSound=function(e){return s(this,void 0,void 0,function(){return a(this,function(){return cc.audioEngine.setEffectsVolume(e),[2]})})},t.prototype.setVolumeBg=function(e){return s(this,void 0,void 0,function(){return a(this,function(){return cc.audioEngine.setMusicVolume(e),[2]})})},t.prototype.playOneShot=function(e){return s(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return[4,this.getClip(e)];case 1:return(t=n.sent())&&cc.audioEngine.playEffect(t,!1),[2]}})})},t.prototype.changeBg=function(e){return s(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return[4,this.getClip(e)];case 1:return(t=n.sent())&&cc.audioEngine.playMusic(t,!0),[2]}})})},t.prototype.getClip=function(e){return s(this,void 0,Promise,function(){var t,n,o;return a(this,function(r){switch(r.label){case 0:return this.caches.has(e)?[2,this.caches[e]]:(t=!1,o=u.PATH_CLIP_SOUND+e,cc.resources.load(o,cc.AudioClip,function(e,r){t=!0,e?console.error("[SoundManager] Failed to load prefab: "+o+" "):n=r}),[4,p.waitUntil(function(){return t})]);case 1:return r.sent(),n&&this.caches.set(e,n),[2,n]}})})},t._instance=null,n=i([l],t)}(cc.Component);n.SoundManager=h,cc._RF.pop()},{"../utils/AsyncUtils":"AsyncUtils","./SoundConfig":"SoundConfig"}],SpinState:[function(e,t,n){"use strict";cc._RF.push(t,"3bf12Ya++5HLqTfYTS53xCW","SpinState");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.SpinState=void 0;var s=e("../core/GameDataConfig"),a=e("./SlotState"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onEnterState=function(){},t.prototype.onExitState=function(){},t.prototype.registerCommandEvents=function(){this.node.on(s.EXECUTE_EVENT.START_SPIN,this.startSpin,this)},t.prototype.unregisterCommandEvents=function(){this.node.off(s.EXECUTE_EVENT.START_SPIN,this.startSpin,this)},t.prototype.startSpin=function(){this.isRunning&&this.getStateMachine().slotTable.startSpin()},i([l],t)}(a.SlotState));n.SpinState=u,cc._RF.pop()},{"../core/GameDataConfig":"GameDataConfig","./SlotState":"SlotState"}],StateDefine:[function(e,t,n){"use strict";var o,r;cc._RF.push(t,"303e7ttqzpOrJMdHXkpYOaJ","StateDefine"),Object.defineProperty(n,"__esModule",{value:!0}),n.STATE_TRANSITION=n.GAME_STATE=void 0,function(e){e[e.NONE=0]="NONE",e[e.IDLE=1]="IDLE",e[e.SPIN=2]="SPIN",e[e.RESULT=3]="RESULT"}(r=n.GAME_STATE||(n.GAME_STATE={})),n.STATE_TRANSITION=((o={})[r.NONE]=[r.IDLE],o[r.IDLE]=[r.SPIN],o[r.SPIN]=[r.RESULT],o[r.RESULT]=[r.IDLE,r.SPIN],o),cc._RF.pop()},{}],StateMachine:[function(e,t,n){"use strict";cc._RF.push(t,"c123bmCNL9N+ZMHKCzlA5VK","StateMachine");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.StateMachine=void 0;var s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._states=new Map,t._currentState=null,t._previousState=null,t}return r(t,e),t.prototype.registerState=function(e,t,n){this._states.has(e)?cc.warn("[StateMachine] State "+e+" is already registered."):(n.stateId=e,n.stateName=t,this._states.set(e,n))},t.prototype.unregisterState=function(e){this._states.has(e)&&this._states.delete(e)},t.prototype.changeState=function(e){var t=this._states.get(e);t?this._currentState!==t?(this.canChangeState(e)||cc.warn("[StateMachine] Cannot change from "+this._currentState.stateId+" to "+e+"."),this._currentState&&(this._currentState.onExit(),this._previousState=this._currentState),this._currentState=t,this._currentState.onEnter()):cc.warn("[StateMachine] Already in state "+e+"."):cc.error("[StateMachine] State "+e+" not found.")},t.prototype.canChangeState=function(){return!0},Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousState",{get:function(){return this._previousState},enumerable:!1,configurable:!0}),t.prototype.isCurrentState=function(e){return!!this._currentState&&this._currentState.stateId===e},t.prototype.clear=function(){this._currentState&&this._currentState.onExit(),this._currentState=null,this._previousState=null,this._states.clear()},i([a],t)}(cc.Component));n.StateMachine=c,cc._RF.pop()},{}],TweenComponent:[function(e,t,n){"use strict";cc._RF.push(t,"3a189QSxtJKV6f7URmtSln+","TweenComponent");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.TweenComponent=void 0;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.safeLabelComp=function(){this.node.getComponent(cc.Label)||this.node.addComponent(cc.Label)},Object.defineProperty(t.prototype,"string",{get:function(){return this.safeLabelComp(),this.node.getComponent(cc.Label).string},set:function(e){this.safeLabelComp(),this.node.getComponent(cc.Label).string=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this.node.opacity},set:function(e){this.node.opacity=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return new cc.Vec3(this.node.scaleX,this.node.scaleY,1)},set:function(e){this.node.setScale(e.x,e.y)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.node.position},set:function(e){this.node.setPosition(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.node.getContentSize()},set:function(e){this.node.setContentSize(e)},enumerable:!1,configurable:!0}),t.prototype.onDestroy=function(){this.node.emit("tween-component-destroyed")},i([cc._decorator.ccclass],t)}(cc.Component);n.TweenComponent=s,cc._RF.pop()},{}],TweenService:[function(e,t,n){"use strict";cc._RF.push(t,"c368flSty5IwZNOqQ3wAfNH","TweenService"),Object.defineProperty(n,"__esModule",{value:!0}),n.TweenService=void 0;var o=e("./TweenComponent"),r=e("./RGPUtils"),i=function(){function e(){this.mapTweenByIdx=new Map,this.mapNodeTweens=new Map,this.tweenIdx=0}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.startTween=function(e,t,n){var o=this,r=this.tweenIdx++,i=e.uuid,s=t.then(cc.tween({}).call(function(){o.onTweenComplete(r,n)})),a={tween:s,node:e,tweenIdx:r,onComplete:n};return this.mapTweenByIdx.set(r,a),this.mapNodeTweens.has(i)||this.mapNodeTweens.set(i,[]),this.mapNodeTweens.get(i).push(r),s.start(),this.getTweenComponent(e),e.once("tween-component-destroyed",function(){return o.clearNodeTweens(e)}),s},e.prototype.onTweenComplete=function(e,t){var n=this.mapTweenByIdx.get(e);if(n){var o=n.node.uuid;this.mapTweenByIdx.delete(e);var r=this.mapNodeTweens.get(o);if(r){var i=r.indexOf(e);-1!==i&&r.splice(i,1),0===r.length&&this.mapNodeTweens.delete(o)}var s=t||n.onComplete;s&&s()}else console.warn("[TweenService] Tween "+e+" not found in map")},e.prototype.clearNodeTweens=function(e){var t=this,n=e.uuid,o=this.mapNodeTweens.get(n);o&&(o.forEach(function(e){var n=t.mapTweenByIdx.get(e);n&&(n.tween.stop(),t.mapTweenByIdx.delete(e))}),this.mapNodeTweens.delete(n)),cc.Tween.stopAllByTarget(e)},e.prototype.clearAllTween=function(){this.mapTweenByIdx.forEach(function(e){e.tween.stop()}),this.mapTweenByIdx.clear(),this.mapNodeTweens.clear()},e.prototype.getTweenComponent=function(e){return e.getComponent(o.TweenComponent)||e.addComponent(o.TweenComponent),e.getComponent(o.TweenComponent)},e.prototype.tweenMoney=function(e,t,n,o){var i=this;void 0===n&&(n=function(){}),this.getTweenComponent(e);var s=t.from,a=t.easing,c=t.to,l=t.duration;o&&this.clearNodeTweens(e);var u={curValue:s},p=a||cc.easing.sineInOut;return this.startTween(e,cc.tween(u).to(l,{curValue:c},{easing:p,onUpdate:function(n){var o=n.curValue;t.isFormatFullMoney?i.getTweenComponent(e).string=r.RGPUtils.Instance.formatFullMoney(o):i.getTweenComponent(e).string=r.RGPUtils.Instance.formatShortMoney(o)}}))},e._instance=null,e}();n.TweenService=i,cc._RF.pop()},{"./RGPUtils":"RGPUtils","./TweenComponent":"TweenComponent"}],UILoginController:[function(e,t,n){"use strict";cc._RF.push(t,"16d59pH+glOzLrsg+GZcqKr","UILoginController");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.UILoginController=void 0;var c=cc._decorator,l=c.ccclass,u=c.property,p=e("./LoginManager"),h=e("../network/GameApiManager"),f=e("../network/GameNetworkManager"),d=e("../network/APIHandler"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputName=null,t.inputEmail=null,t.inputPassword=null,t.btnLogin=null,t.btnRegister=null,t.lbError=null,t}return r(t,e),t.prototype.onLoad=function(){var e=this;null!=cc.sys.localStorage.getItem("email")&&(this.inputEmail.string=cc.sys.localStorage.getItem("email"),this.inputPassword.string=cc.sys.localStorage.getItem("password"),this.inputName.string=cc.sys.localStorage.getItem("username")),this.btnLogin.node.on("click",function(){e.login()}),this.btnRegister.node.on("click",function(){e.register()})},t.prototype.login=function(){return s(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return this.btnLogin.interactable=!1,[4,p.LoginManager.instance.login({emailOrUsername:this.inputEmail.string,password:this.inputPassword.string,rememberMe:!0})];case 1:return(e=t.sent()).success?this.onLoginSuccess():this.lbError.string=e.message,this.btnLogin.interactable=!0,[2]}})})},t.prototype.register=function(){return s(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return this.btnRegister.interactable=!1,[4,p.LoginManager.instance.register({name:this.inputName.string,email:this.inputEmail.string,username:this.inputName.string,password:this.inputPassword.string,confirmPassword:this.inputPassword.string,acceptTerms:!0})];case 1:return(e=t.sent()).success?this.onLoginSuccess():this.lbError.string=e.message,this.btnRegister.interactable=!0,[2]}})})},t.prototype.onLoginSuccess=function(){return s(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return cc.sys.localStorage.setItem("password",this.inputPassword.string),cc.sys.localStorage.setItem("email",this.inputEmail.string),cc.sys.localStorage.setItem("username",this.inputName.string),[4,h.GameApiManager.instance.getBalance()];case 1:return e.sent(),[4,f.default.instance.connect(d.APIHandler.instance.jwt)];case 2:return e.sent(),cc.director.loadScene("main"),[2]}})})},i([u(cc.EditBox)],t.prototype,"inputName",void 0),i([u(cc.EditBox)],t.prototype,"inputEmail",void 0),i([u(cc.EditBox)],t.prototype,"inputPassword",void 0),i([u(cc.Button)],t.prototype,"btnLogin",void 0),i([u(cc.Button)],t.prototype,"btnRegister",void 0),i([u(cc.Label)],t.prototype,"lbError",void 0),i([l],t)}(cc.Component);n.UILoginController=y,cc._RF.pop()},{"../network/APIHandler":"APIHandler","../network/GameApiManager":"GameApiManager","../network/GameNetworkManager":"GameNetworkManager","./LoginManager":"LoginManager"}],VConsoleMgr:[function(e,t,n){"use strict";cc._RF.push(t,"2064bCFBjpN6afoH9WzNg/y","VConsoleMgr");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.VConsoleManager=void 0;var i=e("./ScriptLoader"),s=function(){function e(){this._vConsoleInstance=null,this._isLoading=!1,this.CDN_URL="https://unpkg.com/vconsole@3.15.1/dist/vconsole.min.js"}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.setVisible=function(e){cc.sys.isBrowser?e?this.enable():this.disable():cc.warn("[VConsoleManager] VConsole only supports web/browser platforms.")},e.prototype.enable=function(){this._vConsoleInstance||(window.VConsole?this.initInstance():this.loadScript())},e.prototype.disable=function(){this._vConsoleInstance&&(this._vConsoleInstance.destroy(),this._vConsoleInstance=null,cc.log("[VConsoleManager] Disabled"))},e.prototype.initInstance=function(){try{var e=window.VConsole;e&&(this._vConsoleInstance=new e({theme:"dark"}),cc.log("[VConsoleManager] Enabled Success"))}catch(t){cc.warn("[VConsoleManager] Init Error:",t)}},e.prototype.loadScript=function(){return o(this,void 0,void 0,function(){var e,t=this;return r(this,function(n){switch(n.label){case 0:if(this._isLoading)return[2];this._isLoading=!0,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,i.ScriptLoader.loadScript(this.CDN_URL,{async:!0,onLoad:function(){cc.log("[VConsoleManager] Script loaded!"),t.initInstance()},onError:function(e){cc.warn("[VConsoleManager] Failed to load script. Check internet connection.",e)}})];case 2:return n.sent(),[3,5];case 3:return e=n.sent(),cc.warn("[VConsoleManager] Failed to load script:",e),[3,5];case 4:return this._isLoading=!1,[7];case 5:return[2]}})})},e}();n.VConsoleManager=s,cc._RF.pop()},{"./ScriptLoader":"ScriptLoader"}],WebNoSleep:[function(e,t,n){"use strict";cc._RF.push(t,"3300fi+O/RMSK3RhkH+i2lx","WebNoSleep");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.WebNoSleep=void 0;var i=e("../../utils/ScriptLoader"),s=function(){function e(){this._noSleepInstance=null,this._isScriptLoaded=!1,this._isEnabled=!1,this._clickEventListener=null}return e.prototype.startService=function(){return o(this,void 0,Promise,function(){var e=this;return r(this,function(){return[2,new Promise(function(t,n){cc.sys.isBrowser||(cc.warn("[WebNoSleep] NoSleep only supports web/browser platforms."),t()),e._isScriptLoaded&&(cc.log("[WebNoSleep] NoSleep script already loaded"),t()),i.ScriptLoader.loadScript("https://unpkg.com/nosleep.js@0.12.0/dist/NoSleep.js",{async:!0,onLoad:function(){e._isScriptLoaded=!0,cc.log("[WebNoSleep] NoSleep script loaded successfully"),e.setupClickEventListener(),t()},onError:function(e){cc.warn("[WebNoSleep] Failed to load NoSleep script:",e),n()}})})]})})},e.prototype.enable=function(){if(cc.sys.isBrowser)if(this._isScriptLoaded)try{var e=window.NoSleep;if(!e)return void cc.warn("[WebNoSleep] NoSleep is not available. Script may not be loaded correctly.");this._noSleepInstance=new e,"function"==typeof this._noSleepInstance.enable&&this._noSleepInstance.enable(),this._isEnabled=!0,cc.log("[WebNoSleep] NoSleep enabled successfully")}catch(t){cc.warn("[WebNoSleep] Error enabling NoSleep:",t),this._isEnabled=!1}else cc.warn("[WebNoSleep] NoSleep script not loaded. Cannot enable.");else cc.warn("[WebNoSleep] NoSleep only supports web/browser platforms.")},e.prototype.disable=function(){this._noSleepInstance&&"function"==typeof this._noSleepInstance.disable&&this._noSleepInstance.disable(),this._noSleepInstance=null,this._isEnabled=!1,cc.log("[WebNoSleep] NoSleep disabled")},e.prototype.setupClickEventListener=function(){var e=this;if("undefined"!=typeof window&&void 0!==window.document&&!this._clickEventListener){var t=function(){window.document.removeEventListener("click",t,!1),e._clickEventListener=null,e.enable()};this._clickEventListener=t,window.document.addEventListener("click",t,!1),cc.log("[WebNoSleep] Click event listener added for NoSleep activation")}},e.prototype.cleanup=function(){this._clickEventListener&&"undefined"!=typeof window&&void 0!==window.document&&(window.document.removeEventListener("click",this._clickEventListener,!1),this._clickEventListener=null),this.disable()},e.prototype.toggle=function(){this._isEnabled=!this._isEnabled,this._isEnabled?this.enable():this.disable()},e.prototype.isEnabled=function(){return this._isEnabled},e}();n.WebNoSleep=s,cc._RF.pop()},{"../../utils/ScriptLoader":"ScriptLoader"}],WebSocketClient:[function(e,t,n){"use strict";cc._RF.push(t,"cb31dluPmtNs4pM6meiRlhf","WebSocketClient");var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Emitter"),c={autoReconnect:!0,reconnectDelay:1e3,maxReconnectDelay:3e4,maxReconnectAttempts:1/0,heartbeatInterval:2e4,heartbeatTimeout:1e4,debug:!1},l=Number.MAX_SAFE_INTEGER,u=function(){function e(e){this.emitter=new a.default,this.reconnectAttempts=0,this.isManuallyClosed=!1,this.messageQueue=[],this.requestIdCounter=1,this.pendingRequests=new Map,this.options=o(o({},c),e),this.validateOptions()}return e.prototype.connect=function(){var e;return r(this,void 0,Promise,function(){var t=this;return i(this,function(){return this.isConnecting()||this.isConnected?(this.log("Already connected or connecting"),[2,null!==(e=this.connectPromise)&&void 0!==e?e:Promise.resolve()]):this.connectPromise?[2,this.connectPromise]:(this.isManuallyClosed=!1,this.connectPromise=new Promise(function(e,n){t.connectResolve=e,t.connectReject=n;try{t.log("Connecting to:",t.options.url),t.createWebSocket(),t.attachWebSocketHandlers()}catch(o){t.log("Connection error:",o),t.connectPromise=void 0,n(o)}}),[2,this.connectPromise])})})},e.prototype.send=function(e){if(!this.ws||1!==this.ws.readyState)return this.messageQueue.length>=1e3&&(this.log("Message queue full, dropping oldest message"),this.messageQueue.shift()),this.log("Not connected, queueing message"),void this.messageQueue.push(e);this.sendInternal(e)},e.prototype.emit=function(e,t){var n={event:e,data:null!=t?t:{}};this.send(JSON.stringify(n))},e.prototype.request=function(e,t){var n=this;if(void 0===t&&(t=15e3),!this.isConnected)return Promise.reject(new Error("Not connected"));this.requestIdCounter>=l&&(this.requestIdCounter=1);var o=this.requestIdCounter++,r={__req:!0,__id:o,data:e};return new Promise(function(e,i){var s=setTimeout(function(){n.pendingRequests.get(o)&&(n.pendingRequests.delete(o),i(new Error("Request timeout after "+t+"ms")))},t);n.pendingRequests.set(o,{resolve:e,reject:i,timeoutId:s});try{n.send(JSON.stringify(r))}catch(a){n.pendingRequests.delete(o),clearTimeout(s),i(a)}})},e.prototype.close=function(e,t){if(void 0===e&&(e=1e3),this.isManuallyClosed=!0,this.clearReconnectTimer(),this.stopHeartbeat(),this.clearPendingRequests(),this.connectReject&&(this.connectReject(new Error("Connection closed manually")),this.connectResolve=void 0,this.connectReject=void 0),this.connectPromise=void 0,this.ws&&this.isConnectionActive())try{this.ws.close(e,t)}catch(n){this.log("Error closing WebSocket:",n)}this.removeWebSocketHandlers(),this.ws=void 0,this.reconnectAttempts=0,this.emitter.emit("closed",{code:e,reason:t})},e.prototype.on=function(e,t){return this.emitter.on(e,t)},e.prototype.off=function(e,t){this.emitter.off(e,t)},e.prototype.setAuthToken=function(e){this.options=o(o({},this.options),{auth:o(o({},this.options.auth),{token:e})})},e.prototype.destroy=function(){this.close(),this.removeWebSocketHandlers(),this.emitter.clear(),this.messageQueue=[],this.clearPendingRequests()},Object.defineProperty(e.prototype,"readyState",{get:function(){var e,t;return null!==(t=null===(e=this.ws)||void 0===e?void 0:e.readyState)&&void 0!==t?t:3},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnected",{get:function(){var e;return 1===(null===(e=this.ws)||void 0===e?void 0:e.readyState)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queuedMessageCount",{get:function(){return this.messageQueue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingRequestCount",{get:function(){return this.pendingRequests.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reconnectAttemptsCount",{get:function(){return this.reconnectAttempts},enumerable:!1,configurable:!0}),e.prototype.validateOptions=function(){if(!this.options.url)throw new Error("WebSocket URL is required");var e=this.options.url;if(0!==e.indexOf("ws://")&&0!==e.indexOf("wss://"))throw new Error("WebSocket URL must start with ws:// or wss://");if(this.options.reconnectDelay<0)throw new Error("reconnectDelay must be >= 0");if(this.options.maxReconnectDelay<this.options.reconnectDelay)throw new Error("maxReconnectDelay must be >= reconnectDelay")},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.options.debug&&console.log.apply(console,s(["[NetworkClient]"],e))},e.prototype.isConnecting=function(){var e;return 0===(null===(e=this.ws)||void 0===e?void 0:e.readyState)},e.prototype.isConnectionActive=function(){var e,t=null===(e=this.ws)||void 0===e?void 0:e.readyState;return 1===t||0===t},e.prototype.createWebSocket=function(){try{var e=this.options.url.replace(/token=[^&]+/,"token=***");if(this.log("Creating WebSocket with URL:",e),"undefined"==typeof WebSocket)throw new Error("WebSocket is not supported in this environment");var t=this.options.url.trim();if(!t)throw new Error("WebSocket URL is empty");if(0!==t.indexOf("ws://")&&0!==t.indexOf("wss://"))throw new Error("Invalid WebSocket URL protocol: "+t.substring(0,10));if(this.ws=this.options.protocols?new WebSocket(t,this.options.protocols):new WebSocket(t),!this.ws)throw new Error("Failed to create WebSocket instance");this.log("WebSocket created successfully, setting binaryType");try{this.ws.binaryType="arraybuffer"}catch(n){this.log("Warning: Could not set binaryType, trying blob");try{this.ws.binaryType="blob"}catch(o){this.log("Warning: Could not set binaryType at all")}}this.log("WebSocket ready state:",this.ws.readyState)}catch(r){throw this.log("Error creating WebSocket:",r),r}},e.prototype.attachWebSocketHandlers=function(){var e=this;if(this.ws)try{this.onOpenHandler=function(){e.log("Connection established"),e.reconnectAttempts=0,e.emitter.emit("open"),e.flushMessageQueue(),e.startHeartbeat(),e.connectResolve&&(e.connectResolve(),e.connectResolve=void 0,e.connectReject=void 0,e.connectPromise=void 0)},this.onMessageHandler=function(t){e.handleMessage(t)},this.onCloseHandler=function(t){e.log("Connection closed ["+t.code+"]: "+(t.reason||"No reason")),e.emitter.emit("close",t),e.stopHeartbeat(),e.removeWebSocketHandlers(),e.connectReject&&!e.isManuallyClosed&&(e.connectReject(new Error("Connection closed: "+(t.reason||"Code "+t.code))),e.connectResolve=void 0,e.connectReject=void 0,e.connectPromise=void 0),!e.isManuallyClosed&&e.options.autoReconnect&&e.scheduleReconnect()},this.onErrorHandler=function(t){e.log("Connection error:",t),e.emitter.emit("error",t),e.connectReject&&!e.isManuallyClosed&&(e.connectReject(new Error("WebSocket connection error")),e.connectResolve=void 0,e.connectReject=void 0,e.connectPromise=void 0)},this.log("Attaching WebSocket event handlers"),this.ws.onopen=this.onOpenHandler,this.ws.onmessage=this.onMessageHandler,this.ws.onclose=this.onCloseHandler,this.ws.onerror=this.onErrorHandler,this.log("Event handlers attached successfully")}catch(t){throw this.log("Error attaching WebSocket handlers:",t),t}else this.log("Cannot attach handlers: WebSocket instance is null")},e.prototype.removeWebSocketHandlers=function(){this.ws&&(this.ws.onopen=null,this.ws.onmessage=null,this.ws.onclose=null,this.ws.onerror=null,this.onOpenHandler=void 0,this.onMessageHandler=void 0,this.onCloseHandler=void 0,this.onErrorHandler=void 0)},e.prototype.scheduleReconnect=function(){var e,t=this,n=null!==(e=this.options.maxReconnectAttempts)&&void 0!==e?e:1/0;if(this.reconnectAttempts>=n)return this.log("Max reconnect attempts ("+n+") reached"),void this.emitter.emit("reconnect_failed");this.reconnectAttempts++;var o=this.calculateReconnectDelay();this.log("Scheduling reconnect in "+Math.round(o)+"ms (attempt "+this.reconnectAttempts+"/"+n+")"),this.reconnectTimer=setTimeout(function(){t.isManuallyClosed||(t.emitter.emit("reconnecting",t.reconnectAttempts),t.connect().catch(function(e){t.log("Reconnect failed:",e)}))},o)},e.prototype.calculateReconnectDelay=function(){var e,t,n=null!==(e=this.options.reconnectDelay)&&void 0!==e?e:1e3,o=null!==(t=this.options.maxReconnectDelay)&&void 0!==t?t:3e4,r=300*Math.random(),i=Math.pow(2,this.reconnectAttempts-1)*n;return Math.min(o,i+r)},e.prototype.clearReconnectTimer=function(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=void 0)},e.prototype.flushMessageQueue=function(){if(this.ws&&1===this.ws.readyState){var e=this.messageQueue.length;if(0!==e)for(this.log("Flushing "+e+" queued messages");this.messageQueue.length>0;){var t=this.messageQueue.shift();if(t)try{this.sendInternal(t)}catch(n){this.log("Error sending queued message:",n),this.messageQueue.unshift(t);break}}}},e.prototype.sendInternal=function(e){if(this.ws&&1===this.ws.readyState)try{var t="string"==typeof e?e.substring(0,100):"["+e.byteLength+" bytes]";this.log("Sending message:",t),this.ws.send(e)}catch(n){throw this.log("Send error:",n),this.messageQueue.unshift(e),n}else this.log("Cannot send: WebSocket not open")},e.prototype.handleMessage=function(e){this.resetHeartbeatTimeout();var t=e.data;this.emitter.emit("message",t,e),this.log("<handleMessage> Message received: "+t),"string"==typeof t&&this.handleJsonMessage(t)},e.prototype.handleJsonMessage=function(e){try{var t=JSON.parse(e);if(this.isResponseMessage(t))return void this.handleResponseMessage(t);t.event&&this.emitter.emit(t.event,t.data)}catch(n){this.log("Failed to parse message as JSON:",n)}},e.prototype.isResponseMessage=function(e){return!(!e.__resp||"number"!=typeof e.__id)},e.prototype.handleResponseMessage=function(e){var t=e.__id,n=this.pendingRequests.get(t);if(n){clearTimeout(n.timeoutId),this.pendingRequests.delete(t);try{n.resolve(e.data)}catch(o){this.log("Error in request resolve callback:",o)}}else this.log("Received response for unknown request ID: "+t)},e.prototype.startHeartbeat=function(){var e,t=this;this.stopHeartbeat();var n=null!==(e=this.options.heartbeatInterval)&&void 0!==e?e:2e4;!n||n<=0?this.log("Heartbeat disabled"):(this.log("Starting heartbeat (interval: "+n+"ms, timeout: "+this.options.heartbeatTimeout+"ms)"),this.heartbeatTimer=setInterval(function(){t.sendHeartbeat()},n))},e.prototype.sendHeartbeat=function(){var e,t=this;if(this.ws&&1===this.ws.readyState)try{this.ws.send(JSON.stringify({event:"PING",data:{}}));var n=null!==(e=this.options.heartbeatTimeout)&&void 0!==e?e:1e4;this.heartbeatTimeoutTimer=setTimeout(function(){t.log("Heartbeat timeout - no response from server, closing connection");try{t.ws&&t.ws.close()}catch(e){t.log("Error closing connection on heartbeat timeout:",e)}},n)}catch(o){this.log("Error sending heartbeat:",o)}},e.prototype.resetHeartbeatTimeout=function(){this.heartbeatTimeoutTimer&&(clearTimeout(this.heartbeatTimeoutTimer),this.heartbeatTimeoutTimer=void 0)},e.prototype.stopHeartbeat=function(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0),this.heartbeatTimeoutTimer&&(clearTimeout(this.heartbeatTimeoutTimer),this.heartbeatTimeoutTimer=void 0)},e.prototype.clearPendingRequests=function(){if(0!==this.pendingRequests.size){this.log("Clearing "+this.pendingRequests.size+" pending requests");for(var e=new Error("Connection closed"),t=0,n=this.pendingRequests.entries();t<n.length;t++){var o=n[t],r=(o[0],o[1]);clearTimeout(r.timeoutId);try{r.reject(e)}catch(i){this.log("Error rejecting pending request:",i)}}this.pendingRequests.clear()}},e}();n.default=u,cc._RF.pop()},{"./Emitter":"Emitter"}],index:[function(e,t){"use strict";cc._RF.push(t,"d99b9q8kdhJ0biUsnp9vE38","index"),cc._RF.pop()},{}]},{},["AndroidNoSleep","INoSleep","IOSNoSleep","NoSleepFactory","WebNoSleep","AppController","EnvironmentConfig","SelectServerPopup","index","LoginManager","LoginScreen","UILoginController","GlobalDataManager","GlobalEventManager","APIHandler","ApiTypes","ApiURL","Emitter","GameApiManager","GameNetworkManager","NetworkConfig","NetworkConstants","NetworkTypes","WebSocketClient","CommandManager","ProcessCommand","BaseState","StateMachine","BasePopup","BasicPopup","GenericPopup","LoadingOverlay","PopupConfig","PopupData","PopupManager","SceneManager","BaseScreen","ScreenConfig","ScreenManager","SoundConfig","SoundManager","AsyncUtils","InterfaceTweenHub","Logger","RGPUtils","ScriptLoader","TweenComponent","TweenService","VConsoleMgr","MockApi","Declaration","GameAssetsManager","MainScreen","SlotComponent","SlotController","EventsConstants","GameConstants","GameDataConfig","GameDataType","GameDataWrapper","GlobalEvents","SlotReel","SlotReelControl","SlotSymbol","SlotTable","IdleState","ResultState","SlotState","SpinState","StateDefine"]);